<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Ø¥Ø¯Ø§Ø±Ø© Ù…Ù‡Ù†Ø¯Ø³ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª - Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</title><link rel="stylesheet" href="css/style.css"><link rel="stylesheet" href="css/navigation.css"><style> .sales-engineers-container { max-width: 1400px; margin: 20px auto; padding: 0 20px; } .page-header { background: linear-gradient(135deg, #2c3e50, #34495e); color: white; padding: 30px; border-radius: 15px; margin-bottom: 30px; text-align: center; } .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; } .stat-card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1); text-align: center; border-top: 4px solid; } .stat-card.total { border-top-color: #3498db; } .stat-card.active { border-top-color: #27ae60; } .stat-card.sales { border-top-color: #f39c12; } .stat-card.commission { border-top-color: #e74c3c; } .stat-number { font-size: 2.5em; font-weight: bold; margin-bottom: 10px; } .main-content { background: white; border-radius: 15px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1); overflow: hidden; } .content-header { background: #f8f9fa; padding: 25px 30px; border-bottom: 1px solid #dee2e6; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 20px; } .search-filters { display: flex; gap: 15px; align-items: center; flex-wrap: wrap; } .search-box { position: relative; min-width: 300px; } .search-input { width: 100%; padding: 12px 45px 12px 15px; border: 2px solid #e0e0e0; border-radius: 25px; font-size: 1em; transition: border-color 0.3s ease; } .search-input:focus { outline: none; border-color: #3498db; } .search-icon { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: #7f8c8d; } .filter-select { padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1em; min-width: 150px; } .btn-group { display: flex; gap: 10px; } .btn { padding: 12px 25px; border: none; border-radius: 8px; cursor: pointer; font-size: 1em; font-weight: 500; transition: all 0.3s ease; text-decoration: none; display: inline-flex; align-items: center; gap: 8px; } .btn-primary { background: #3498db; color: white; } .btn-primary:hover { background: #2980b9; transform: translateY(-2px); } .btn-success { background: #27ae60; color: white; } .btn-success:hover { background: #229954; } .btn-warning { background: #f39c12; color: white; } .btn-danger { background: #e74c3c; color: white; } .btn-sm { padding: 6px 12px; font-size: 0.9em; } .data-table { width: 100%; border-collapse: collapse; } .data-table th { background: #f8f9fa; padding: 15px; text-align: right; font-weight: 600; border-bottom: 2px solid #dee2e6; position: sticky; top: 0; z-index: 10; } .data-table td { padding: 15px; border-bottom: 1px solid #f0f0f0; vertical-align: middle; } .data-table tr:hover { background: #f8f9fa; } .engineer-info { display: flex; align-items: center; gap: 12px; } .engineer-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(135deg, #3498db, #2980b9); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 1.2em; } .engineer-details h4 { margin: 0; font-size: 1.1em; color: #2c3e50; } .engineer-details p { margin: 2px 0 0 0; font-size: 0.9em; color: #7f8c8d; } .status-badge { padding: 5px 12px; border-radius: 20px; font-size: 0.9em; font-weight: 500; } .status-active { background: #d4edda; color: #155724; } .status-inactive { background: #f8d7da; color: #721c24; } .status-suspended { background: #fff3cd; color: #856404; } .performance-indicator { display: flex; align-items: center; gap: 8px; } .progress-bar { width: 100px; height: 8px; background: #e9ecef; border-radius: 4px; overflow: hidden; } .progress-fill { height: 100%; background: linear-gradient(90deg, #27ae60, #2ecc71); transition: width 0.3s ease; } .action-buttons { display: flex; gap: 8px; } .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); z-index: 1000; } .modal-content { background: white; margin: 3% auto; padding: 0; border-radius: 15px; max-width: 800px; max-height: 90vh; overflow-y: auto; } .modal-header { padding: 25px 30px; border-bottom: 1px solid #dee2e6; display: flex; justify-content: space-between; align-items: center; background: #f8f9fa; border-radius: 15px 15px 0 0; } .modal-body { padding: 30px; } .modal-footer { padding: 20px 30px; border-top: 1px solid #dee2e6; display: flex; justify-content: flex-end; gap: 10px; background: #f8f9fa; border-radius: 0 0 15px 15px; } .close-btn { background: none; border: none; font-size: 1.5em; cursor: pointer; color: #7f8c8d; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; } .form-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 25px; } .form-group { margin-bottom: 20px; } .form-label { display: block; margin-bottom: 8px; font-weight: 500; color: #2c3e50; } .form-control { width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 1em; transition: border-color 0.3s ease; } .form-control:focus { outline: none; border-color: #3498db; } .pagination { display: flex; justify-content: center; align-items: center; gap: 10px; padding: 20px; background: #f8f9fa; } .pagination button { padding: 8px 12px; border: 1px solid #dee2e6; background: white; cursor: pointer; border-radius: 4px; } .pagination button.active { background: #3498db; color: white; border-color: #3498db; } .empty-state { text-align: center; padding: 60px 20px; color: #7f8c8d; } .empty-state .icon { font-size: 4em; margin-bottom: 20px; } @media (max-width: 768px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } .content-header { flex-direction: column; align-items: stretch; } .search-filters { flex-direction: column; } .search-box { min-width: auto; } .btn-group { justify-content: center; } .data-table { font-size: 0.9em; } .form-grid { grid-template-columns: 1fr; } } </style></head><body><div class="sales-engineers-container"><div class="page-header"><h1>ğŸ‘¨â€ğŸ’¼ Ø¥Ø¯Ø§Ø±Ø© Ù…Ù‡Ù†Ø¯Ø³ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h1><p>Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ÙˆØªØªØ¨Ø¹ Ø§Ù„Ø£Ø¯Ø§Ø¡ ÙˆØ§Ù„Ø¹Ù…ÙˆÙ„Ø§Øª</p></div><div class="stats-grid"><div class="stat-card total"><div class="stat-number" id="totalEngineers">0</div><div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ†</div></div><div class="stat-card active"><div class="stat-number" id="activeEngineers">0</div><div class="stat-label">Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† Ø§Ù„Ù†Ø´Ø·ÙŠÙ†</div></div><div class="stat-card sales"><div class="stat-number" id="totalSales">0</div><div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</div></div><div class="stat-card commission"><div class="stat-number" id="totalCommission">0</div><div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹Ù…ÙˆÙ„Ø§Øª</div></div></div><div class="main-content"><div class="content-header"><div class="search-filters"><div class="search-box"><input type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ" class="search-input" placeholder="Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ù…Ù‡Ù†Ø¯Ø³ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª..." id="searchInput" aria-label="Ø­Ù‚Ù„ Ù†Øµ"><span class="search-icon">ğŸ”</span></div><select class="filter-select" id="statusFilter"><option value="">Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ø§Ù„Ø§Øª</option><option value="active">Ù†Ø´Ø·</option><option value="inactive">ØºÙŠØ± Ù†Ø´Ø·</option><option value="suspended">Ù…Ø¹Ù„Ù‚</option></select></div><div class="btn-group"><button type="button" class="btn btn-primary" onclick="addEngineer()"> â• Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù†Ø¯Ø³ </button><button type="button" class="btn btn-success" onclick="exportEngineers()"> ğŸ“Š ØªØµØ¯ÙŠØ± </button><button type="button" class="btn btn-warning" onclick="importEngineers()"> ğŸ“¥ Ø§Ø³ØªÙŠØ±Ø§Ø¯ </button></div></div><div class="table-container"><table class="data-table" id="engineersTable"><thead><tr><th>Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³</th><th>Ù…Ø¹Ø±Ù Ø§Ù„Ù…ÙˆØ¸Ù</th><th>Ø§Ù„Ù‡Ø§ØªÙ</th><th>Ù†Ø³Ø¨Ø© Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©</th><th>Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø´Ù‡Ø±ÙŠ</th><th>Ø§Ù„Ø£Ø¯Ø§Ø¡</th><th>Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th></tr></thead><tbody id="engineersTableBody"><!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ --></tbody></table></div><div class="pagination" id="pagination"><!-- Ø³ÙŠØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ --></div></div></div><!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ù…Ù‡Ù†Ø¯Ø³ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª --><div id="engineerModal" class="modal"><div class="modal-content"><div class="modal-header"><h3 id="engineerModalTitle">Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù†Ø¯Ø³ Ù…Ø¨ÙŠØ¹Ø§Øª Ø¬Ø¯ÙŠØ¯</h3><button type="button" class="close-btn" onclick="closeModal('engineerModal')">&times;</button></div><div class="modal-body"><form id="engineerForm"><div class="form-grid"><div class="form-group"><label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ *</label><input type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ" class="form-control" id="engineerName" required aria-label="Ø­Ù‚Ù„ Ù†Øµ"></div><div class="form-group"><label class="form-label">Ù…Ø¹Ø±Ù Ø§Ù„Ù…ÙˆØ¸Ù *</label><input type="text" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ" class="form-control" id="employeeId" required aria-label="Ø­Ù‚Ù„ Ù†Øµ"></div><div class="form-group"><label class="form-label">Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ *</label><input type="email" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" class="form-control" id="engineerEmail" required aria-label="Ø­Ù‚Ù„ Ø¨Ø±ÙŠØ¯ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ"></div><div class="form-group"><label class="form-label">Ø§Ù„Ù‡Ø§ØªÙ</label><input type="tel" class="form-control" id="engineerPhone"></div><div class="form-group"><label class="form-label">Ø§Ù„Ø¬ÙˆØ§Ù„</label><input type="tel" class="form-control" id="engineerMobile"></div><div class="form-group"><label class="form-label">Ù†Ø³Ø¨Ø© Ø§Ù„Ø¹Ù…ÙˆÙ„Ø© (%)</label><input type="number" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù…" class="form-control" id="commissionRate" min="0" max="100" step="0.1" aria-label="Ø­Ù‚Ù„ Ø±Ù‚Ù…"></div><div class="form-group"><label class="form-label">Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ø´Ù‡Ø±ÙŠ</label><input type="number" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù…" class="form-control" id="targetMonthly" min="0" step="0.01" aria-label="Ø­Ù‚Ù„ Ø±Ù‚Ù…"></div><div class="form-group"><label class="form-label">Ø§Ù„Ø­Ø§Ù„Ø©</label><select class="form-control" id="engineerStatus"><option value="active">Ù†Ø´Ø·</option><option value="inactive">ØºÙŠØ± Ù†Ø´Ø·</option><option value="suspended">Ù…Ø¹Ù„Ù‚</option></select></div></div><div class="form-group"><label class="form-label">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><textarea class="form-control" id="engineerAddress" rows="2"></textarea></div><div class="form-group"><label class="form-label">Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label><textarea class="form-control" id="engineerNotes" rows="3"></textarea></div></form></div><div class="modal-footer"><button type="button" class="btn btn-primary" onclick="saveEngineer()">ğŸ’¾ Ø­ÙØ¸</button><button type="button" class="btn" onclick="closeModal('engineerModal')">Ø¥Ù„ØºØ§Ø¡</button></div></div></div><script src="js/navigation.js"></script><script> // Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø© let currentPage = 1; let totalPages = 1; let currentEngineerId = null; let engineers = []; // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ Ø§Ù„ØµÙØ­Ø© document.addEventListener('DOMContentLoaded', function() { loadEngineers(); loadStats(); // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨Ø­Ø« document.getElementById('searchInput').addEventListener('input', function() { currentPage = 1; loadEngineers(); }); // Ø¥Ø¹Ø¯Ø§Ø¯ ÙÙ„ØªØ± Ø§Ù„Ø­Ø§Ù„Ø© document.getElementById('statusFilter').addEventListener('change', function() { currentPage = 1; loadEngineers(); }); }); // ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† async function loadEngineers() { try { const search = document.getElementById('searchInput').value; const status = document.getElementById('statusFilter').value; const params = new URLSearchParams({ page: currentPage, per_page: 20, search: search, status: status }); const response = await fetch(`/api/sales-engineers?${params}`); const data = await response.json(); if (data.success) { engineers = data.data; displayEngineers(engineers); updatePagination(data.pagination); } else { showError('ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ†'); } } catch (error) { console.error('Error loading engineers:', error); showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'); } } // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† function displayEngineers(engineers) { const tbody = document.getElementById('engineersTableBody'); if (engineers.length === 0) { tbody.innerHTML = ` <tr><td colspan="9" class="empty-state"><div class="icon">ğŸ‘¨â€ğŸ’¼</div><h3>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† Ù…Ø¨ÙŠØ¹Ø§Øª</h3><p>Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù†Ø¯Ø³ Ù…Ø¨ÙŠØ¹Ø§Øª Ø¬Ø¯ÙŠØ¯</p></td></tr> `; return; } tbody.innerHTML = engineers.map(engineer => ` <tr><td><div class="engineer-info"><div class="engineer-avatar"> ${engineer.name.charAt(0)} </div><div class="engineer-details"><h4>${engineer.name}</h4><p>${engineer.email}</p></div></div></td><td>${engineer.employee_id}</td><td>${engineer.mobile || engineer.phone || '-'}</td><td>${engineer.commission_rate}%</td><td>${formatCurrency(engineer.target_monthly)}</td><td><div class="performance-indicator"><div class="progress-bar"><div class="progress-fill" style="width: ${Math.min(100, (engineer.total_sales / engineer.target_monthly) * 100)}%"></div></div><span>${Math.round((engineer.total_sales / engineer.target_monthly) * 100) || 0}%</span></div></td><td>${engineer.customers_count}</td><td><span class="status-badge status-${engineer.status}"> ${getStatusText(engineer.status)} </span></td><td><div class="action-buttons"><button type="button" class="btn btn-primary btn-sm" onclick="viewEngineer(${engineer.id})" title="Ø¹Ø±Ø¶"> ğŸ‘ï¸ </button><button type="button" class="btn btn-warning btn-sm" onclick="editEngineer(${engineer.id})" title="ØªØ¹Ø¯ÙŠÙ„"> âœï¸ </button><button type="button" class="btn btn-success btn-sm" onclick="viewEngineerCustomers(${engineer.id})" title="Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡"> ğŸ‘¥ </button><button type="button" class="btn btn-danger btn-sm" onclick="deleteEngineer(${engineer.id})" title="Ø­Ø°Ù"> ğŸ—‘ï¸ </button></div></td></tr> `).join(''); } // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª async function loadStats() { try { const response = await fetch('/api/dashboard/stats'); const data = await response.json(); if (data.success) { document.getElementById('totalEngineers').textContent = data.data.active_engineers || 0; document.getElementById('activeEngineers').textContent = data.data.active_engineers || 0; document.getElementById('totalSales').textContent = formatCurrency(data.data.today_sales || 0); document.getElementById('totalCommission').textContent = formatCurrency((data.data.today_sales || 0) * 0.05); // Ø§ÙØªØ±Ø§Ø¶ 5% Ø¹Ù…ÙˆÙ„Ø© } } catch (error) { console.error('Error loading stats:', error); } } // Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù†Ø¯Ø³ Ø¬Ø¯ÙŠØ¯ function addEngineer() { currentEngineerId = null; document.getElementById('engineerModalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ù…Ù‡Ù†Ø¯Ø³ Ù…Ø¨ÙŠØ¹Ø§Øª Ø¬Ø¯ÙŠØ¯'; document.getElementById('engineerForm').reset(); openModal('engineerModal'); } // ØªØ¹Ø¯ÙŠÙ„ Ù…Ù‡Ù†Ø¯Ø³ function editEngineer(id) { const engineer = engineers.find(e => e.id === id); if (!engineer) return; currentEngineerId = id; document.getElementById('engineerModalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ù…Ù‡Ù†Ø¯Ø³ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª'; // Ù…Ù„Ø¡ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª document.getElementById('engineerName').value = engineer.name; document.getElementById('employeeId').value = engineer.employee_id; document.getElementById('engineerEmail').value = engineer.email; document.getElementById('engineerPhone').value = engineer.phone || ''; document.getElementById('engineerMobile').value = engineer.mobile || ''; document.getElementById('commissionRate').value = engineer.commission_rate; document.getElementById('targetMonthly').value = engineer.target_monthly; document.getElementById('engineerStatus').value = engineer.status; document.getElementById('engineerAddress').value = engineer.address || ''; document.getElementById('engineerNotes').value = engineer.notes || ''; openModal('engineerModal'); } // Ø­ÙØ¸ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ async function saveEngineer() { try { const form = document.getElementById('engineerForm'); if (!form.checkValidity()) { form.reportValidity(); return; } const formData = { name: document.getElementById('engineerName').value, employee_id: document.getElementById('employeeId').value, email: document.getElementById('engineerEmail').value, phone: document.getElementById('engineerPhone').value, mobile: document.getElementById('engineerMobile').value, commission_rate: parseFloat(document.getElementById('commissionRate').value) || 0, target_monthly: parseFloat(document.getElementById('targetMonthly').value) || 0, status: document.getElementById('engineerStatus').value, address: document.getElementById('engineerAddress').value, notes: document.getElementById('engineerNotes').value }; const url = currentEngineerId ? `/api/sales-engineers/${currentEngineerId}` : '/api/sales-engineers'; const method = currentEngineerId ? 'PUT' : 'POST'; const response = await fetch(url, { method: method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(formData) }); const data = await response.json(); if (data.success) { showSuccess(data.message); closeModal('engineerModal'); loadEngineers(); loadStats(); } else { showError(data.message); } } catch (error) { console.error('Error saving engineer:', error); showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'); } } // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ function viewEngineer(id) { const engineer = engineers.find(e => e.id === id); if (!engineer) return; alert(`ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³:\n\nØ§Ù„Ø§Ø³Ù…: ${engineer.name}\nÙ…Ø¹Ø±Ù Ø§Ù„Ù…ÙˆØ¸Ù: ${engineer.employee_id}\nØ§Ù„Ø¥ÙŠÙ…ÙŠÙ„: ${engineer.email}\nØ§Ù„Ù‡Ø§ØªÙ: ${engineer.mobile || engineer.phone || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}\nÙ†Ø³Ø¨Ø© Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©: ${engineer.commission_rate}%\nØ§Ù„Ù‡Ø¯Ù Ø§Ù„Ø´Ù‡Ø±ÙŠ: ${formatCurrency(engineer.target_monthly)}\nØ¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡: ${engineer.customers_count}\nØ¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª: ${formatCurrency(engineer.total_sales)}`); } // Ø¹Ø±Ø¶ Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ function viewEngineerCustomers(id) { // Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ù„Ø§Ø­Ù‚Ø§Ù‹ alert('Ø³ÙŠØªÙ… ÙØªØ­ ØµÙØ­Ø© Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³'); } // Ø­Ø°Ù Ù…Ù‡Ù†Ø¯Ø³ async function deleteEngineer(id) { if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ØŸ\nØ³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ù‡.')) { return; } try { const response = await fetch(`/api/sales-engineers/${id}`, { method: 'DELETE' }); const data = await response.json(); if (data.success) { showSuccess('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø¨Ù†Ø¬Ø§Ø­'); loadEngineers(); loadStats(); } else { showError(data.message); } } catch (error) { console.error('Error deleting engineer:', error); showError('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³'); } } // ØªØµØ¯ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª function exportEngineers() { // Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ù„Ø§Ø­Ù‚Ø§Ù‹ alert('Ø³ÙŠØªÙ… ØªØµØ¯ÙŠØ± Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† Ø¥Ù„Ù‰ Excel'); } // Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª function importEngineers() { // Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¸ÙŠÙØ© Ù„Ø§Ø­Ù‚Ø§Ù‹ alert('Ø³ÙŠØªÙ… Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ† Ù…Ù† Excel'); } // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© function openModal(modalId) { document.getElementById(modalId).style.display = 'block'; } function closeModal(modalId) { document.getElementById(modalId).style.display = 'none'; } // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§ window.onclick = function(event) { if (event.target.classList.contains('modal')) { event.target.style.display = 'none'; } } // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª function updatePagination(pagination) { totalPages = pagination.pages; const paginationDiv = document.getElementById('pagination'); if (totalPages <= 1) { paginationDiv.innerHTML = ''; return; } let paginationHTML = ''; // Ø²Ø± Ø§Ù„Ø³Ø§Ø¨Ù‚ if (currentPage > 1) { paginationHTML += `<button onclick="changePage(${currentPage - 1})">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>`; } // Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ØµÙØ­Ø§Øª for (let i = 1; i <= totalPages; i++) { if (i === currentPage) { paginationHTML += `<button class="active">${i}</button>`; } else { paginationHTML += `<button onclick="changePage(${i})">${i}</button>`; } } // Ø²Ø± Ø§Ù„ØªØ§Ù„ÙŠ if (currentPage < totalPages) { paginationHTML += `<button onclick="changePage(${currentPage + 1})">Ø§Ù„ØªØ§Ù„ÙŠ</button>`; } paginationDiv.innerHTML = paginationHTML; } // ØªØºÙŠÙŠØ± Ø§Ù„ØµÙØ­Ø© function changePage(page) { currentPage = page; loadEngineers(); } // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© function formatCurrency(amount) { return new Intl.NumberFormat('ar-SA', { style: 'currency', currency: 'SAR' }).format(amount || 0); } function getStatusText(status) { const statusMap = { 'active': 'Ù†Ø´Ø·', 'inactive': 'ØºÙŠØ± Ù†Ø´Ø·', 'suspended': 'Ù…Ø¹Ù„Ù‚' }; return statusMap[status] || status; } function showSuccess(message) { alert('âœ… ' + message); } function showError(message) { alert('âŒ ' + message); } </script></body></html> 