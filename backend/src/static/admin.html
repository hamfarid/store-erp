<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>إدارة المستخدمين - نظام إدارة المخزون</title><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"><style> * { margin: 0; padding: 0; box-sizing: border-box; } body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; direction: rtl; } .container { max-width: 1400px; margin: 0 auto; padding: 20px; } .header { background: rgba(255, 255, 255, 0.95); -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px); border-radius: 15px; padding: 20px; margin-bottom: 30px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); text-align: center; } .header h1 { color: #2c3e50; font-size: 2.5rem; margin-bottom: 10px; font-weight: 700; } .tabs { display: flex; gap: 10px; margin-bottom: 30px; justify-content: center; } .tab-btn { background: rgba(255, 255, 255, 0.9); border: none; padding: 12px 25px; border-radius: 10px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease; color: #2c3e50; } .tab-btn.active { background: linear-gradient(135deg, #3498db, #2980b9); color: white; transform: translateY(-2px); box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3); } .tab-content { display: none; } .tab-content.active { display: block; } .section-card { background: rgba(255, 255, 255, 0.95); -webkit-backdrop-filter: blur(10px); backdrop-filter: blur(10px); border-radius: 15px; padding: 25px; margin-bottom: 25px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); } .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #e9ecef; } .section-header h3 { color: #2c3e50; font-size: 1.5rem; display: flex; align-items: center; gap: 10px; } .btn { padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; transition: all 0.3s ease; text-decoration: none; display: inline-block; text-align: center; } .btn-primary { background: linear-gradient(135deg, #3498db, #2980b9); color: white; } .btn-success { background: linear-gradient(135deg, #2ecc71, #27ae60); color: white; } .btn-warning { background: linear-gradient(135deg, #f39c12, #e67e22); color: white; } .btn-danger { background: linear-gradient(135deg, #e74c3c, #c0392b); color: white; } .btn-secondary { background: linear-gradient(135deg, #6c757d, #495057); color: white; } .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); } .data-table { width: 100%; border-collapse: collapse; margin-top: 20px; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); } .data-table th, .data-table td { padding: 12px; text-align: center; border-bottom: 1px solid #e9ecef; } .data-table th { background: #3498db; color: white; font-weight: 600; } .data-table tr:nth-child(even) { background: #f8f9fa; } .data-table tr:hover { background: #e3f2fd; } .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.5); -webkit-backdrop-filter: blur(5px); backdrop-filter: blur(5px); } .modal-content { background: white; margin: 5% auto; padding: 30px; border-radius: 15px; width: 90%; max-width: 600px; box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3); position: relative; } .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 2px solid #e9ecef; } .modal-header h3 { color: #2c3e50; font-size: 1.5rem; } .close { color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; transition: color 0.3s ease; } .close:hover { color: #e74c3c; } .form-group { margin-bottom: 20px; } .form-group label { display: block; margin-bottom: 8px; color: #2c3e50; font-weight: 600; } .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 1rem; transition: border-color 0.3s ease; } .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #3498db; } .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; } .permissions-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 15px; } .permission-item { background: #f8f9fa; padding: 15px; border-radius: 8px; border: 1px solid #e9ecef; } .permission-item label { display: flex; align-items: center; gap: 10px; cursor: pointer; margin: 0; } .permission-item input[type="checkbox"] { width: auto; margin: 0; } .status-badge { padding: 5px 10px; border-radius: 15px; font-size: 0.8rem; font-weight: 600; } .status-active { background: #d4edda; color: #155724; } .status-inactive { background: #f8d7da; color: #721c24; } .back-btn { background: linear-gradient(135deg, #6c757d, #495057); color: white; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; text-decoration: none; display: inline-block; margin-bottom: 20px; transition: all 0.3s ease; } .back-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); } .loading { text-align: center; padding: 40px; color: #6c757d; } .loading i { font-size: 2rem; animation: spin 1s linear infinite; } @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } } .alert { padding: 15px; margin-bottom: 20px; border-radius: 8px; font-weight: 600; } .alert-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; } .alert-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; } @media (max-width: 768px) { .form-row { grid-template-columns: 1fr; } .permissions-grid { grid-template-columns: 1fr; } .tabs { flex-direction: column; } } </style></head><body><div class="container"><!-- الرأس --><div class="header"><h1><i class="fas fa-users-cog"></i> إدارة المستخدمين والصلاحيات</h1><p>إدارة شاملة للمستخدمين والأدوار والصلاحيات</p><a href="/" class="back-btn"><i class="fas fa-arrow-right"></i> العودة للرئيسية </a></div><!-- التبويبات --><div class="tabs"><button type="button" class="tab-btn active" onclick="showTab('users')"><i class="fas fa-users"></i> المستخدمين </button><button type="button" class="tab-btn" onclick="showTab('roles')"><i class="fas fa-user-tag"></i> الأدوار </button><button type="button" class="tab-btn" onclick="showTab('activity')"><i class="fas fa-chart-line"></i> النشاط </button></div><!-- تبويب المستخدمين --><div id="users-tab" class="tab-content active"><div class="section-card"><div class="section-header"><h3><i class="fas fa-users"></i> إدارة المستخدمين</h3><button type="button" class="btn btn-primary" onclick="showUserModal()"><i class="fas fa-plus"></i> إضافة مستخدم جديد </button></div><div id="users-loading" class="loading"><i class="fas fa-spinner"></i><p>جاري تحميل المستخدمين...</p></div><div id="users-table-container" style="display: none;"><table class="data-table" id="users-table"><thead><tr><th>اسم المستخدم</th><th>الاسم الكامل</th><th>البريد الإلكتروني</th><th>الدور</th><th>الحالة</th><th>آخر دخول</th><th>الإجراءات</th></tr></thead><tbody id="users-tbody"></tbody></table></div></div></div><!-- تبويب الأدوار --><div id="roles-tab" class="tab-content"><div class="section-card"><div class="section-header"><h3><i class="fas fa-user-tag"></i> إدارة الأدوار</h3><button type="button" class="btn btn-primary" onclick="showRoleModal()"><i class="fas fa-plus"></i> إضافة دور جديد </button></div><div id="roles-loading" class="loading"><i class="fas fa-spinner"></i><p>جاري تحميل الأدوار...</p></div><div id="roles-table-container" style="display: none;"><table class="data-table" id="roles-table"><thead><tr><th>اسم الدور</th><th>الوصف</th><th>عدد المستخدمين</th><th>تاريخ الإنشاء</th><th>الإجراءات</th></tr></thead><tbody id="roles-tbody"></tbody></table></div></div></div><!-- تبويب النشاط --><div id="activity-tab" class="tab-content"><div class="section-card"><div class="section-header"><h3><i class="fas fa-chart-line"></i> نشاط المستخدمين</h3><button type="button" class="btn btn-secondary" onclick="loadUserActivity()"><i class="fas fa-sync"></i> تحديث </button></div><div id="activity-stats" class="summary-cards" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;"><!-- سيتم ملؤها ديناميكياً --></div><div id="activity-table-container"><table class="data-table" id="activity-table"><thead><tr><th>المستخدم</th><th>الاسم الكامل</th><th>الدور</th><th>آخر دخول</th><th>الحالة</th></tr></thead><tbody id="activity-tbody"></tbody></table></div></div></div></div><!-- نافذة إضافة/تعديل المستخدم --><div id="user-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3 id="user-modal-title">إضافة مستخدم جديد</h3><span class="close" onclick="closeUserModal()" role="button" tabindex="0" aria-label="عنصر تفاعلي">&times;</span></div><div id="user-alert" style="display: none;"></div><form id="user-form"><div class="form-row"><div class="form-group"><label for="user-username">اسم المستخدم *</label><input type="text" placeholder="أدخل النص" id="user-username" required aria-label="حقل نص"></div><div class="form-group"><label for="user-email">البريد الإلكتروني *</label><input type="email" placeholder="أدخل البريد الإلكتروني" id="user-email" required aria-label="حقل بريد إلكتروني"></div></div><div class="form-row"><div class="form-group"><label for="user-full-name">الاسم الكامل *</label><input type="text" placeholder="أدخل النص" id="user-full-name" required aria-label="حقل نص"></div><div class="form-group"><label for="user-phone">رقم الهاتف</label><input type="tel" id="user-phone"></div></div><div class="form-row"><div class="form-group"><label for="user-role">الدور *</label><select id="user-role" required><option value="">اختر الدور</option></select></div><div class="form-group"><label for="user-password">كلمة المرور *</label><input type="password" id="user-password" required></div></div><div class="form-group"><label><input type="checkbox" id="user-active" checked> المستخدم نشط </label></div><div style="text-align: center; margin-top: 30px;"><button type="submit" class="btn btn-success"><i class="fas fa-save"></i> حفظ </button><button type="button" class="btn btn-secondary" onclick="closeUserModal()"><i class="fas fa-times"></i> إلغاء </button></div></form></div></div><!-- نافذة إضافة/تعديل الدور --><div id="role-modal" class="modal"><div class="modal-content"><div class="modal-header"><h3 id="role-modal-title">إضافة دور جديد</h3><span class="close" onclick="closeRoleModal()" role="button" tabindex="0" aria-label="عنصر تفاعلي">&times;</span></div><div id="role-alert" style="display: none;"></div><form id="role-form"><div class="form-group"><label for="role-name">اسم الدور *</label><input type="text" placeholder="أدخل النص" id="role-name" required aria-label="حقل نص"></div><div class="form-group"><label for="role-description">الوصف</label><textarea id="role-description" rows="3"></textarea></div><div class="form-group"><label>الصلاحيات</label><div id="permissions-container" class="permissions-grid"><!-- سيتم ملؤها ديناميكياً --></div></div><div style="text-align: center; margin-top: 30px;"><button type="submit" class="btn btn-success"><i class="fas fa-save"></i> حفظ </button><button type="button" class="btn btn-secondary" onclick="closeRoleModal()"><i class="fas fa-times"></i> إلغاء </button></div></form></div></div><script> // متغيرات عامة let currentUsers = []; let currentRoles = []; let availablePermissions = {}; let editingUserId = null; let editingRoleId = null; // تحميل البيانات الأولية document.addEventListener('DOMContentLoaded', function() { loadUsers(); loadRoles(); loadPermissions(); loadSystemStats(); }); // إدارة التبويبات function showTab(tabName) { // إخفاء جميع التبويبات document.querySelectorAll('.tab-content').forEach(tab => { tab.classList.remove('active'); }); document.querySelectorAll('.tab-btn').forEach(btn => { btn.classList.remove('active'); }); // إظهار التبويب المحدد document.getElementById(tabName + '-tab').classList.add('active'); event.target.classList.add('active'); // تحميل البيانات حسب التبويب if (tabName === 'users') { loadUsers(); } else if (tabName === 'roles') { loadRoles(); } else if (tabName === 'activity') { loadUserActivity(); } } // تحميل المستخدمين async function loadUsers() { try { document.getElementById('users-loading').style.display = 'block'; document.getElementById('users-table-container').style.display = 'none'; const response = await fetch('/api/users'); const data = await response.json(); if (data.success) { currentUsers = data.data; displayUsers(data.data); } else { showAlert('error', 'خطأ في تحميل المستخدمين: ' + data.message); } } catch (error) { console.error('خطأ في تحميل المستخدمين:', error); showAlert('error', 'حدث خطأ في تحميل المستخدمين'); } finally { document.getElementById('users-loading').style.display = 'none'; document.getElementById('users-table-container').style.display = 'block'; } } // عرض المستخدمين function displayUsers(users) { const tbody = document.getElementById('users-tbody'); tbody.innerHTML = ''; users.forEach(user => { const row = document.createElement('tr'); row.innerHTML = ` <td>${user.username}</td><td>${user.full_name}</td><td>${user.email}</td><td>${user.role_name || 'غير محدد'}</td><td><span class="status-badge ${user.is_active ? 'status-active' : 'status-inactive'}"> ${user.is_active ? 'نشط' : 'غير نشط'} </span></td><td>${user.last_login ? new Date(user.last_login).toLocaleDateString('ar-EG') : 'لم يدخل بعد'}</td><td><button type="button" class="btn btn-warning" onclick="editUser(${user.id})" style="margin: 2px;"><i class="fas fa-edit"></i></button><button type="button" class="btn btn-danger" onclick="deleteUser(${user.id})" style="margin: 2px;"><i class="fas fa-trash"></i></button></td> `; tbody.appendChild(row); }); } // تحميل الأدوار async function loadRoles() { try { document.getElementById('roles-loading').style.display = 'block'; document.getElementById('roles-table-container').style.display = 'none'; const response = await fetch('/api/roles'); const data = await response.json(); if (data.success) { currentRoles = data.data; displayRoles(data.data); updateRoleSelect(data.data); } else { showAlert('error', 'خطأ في تحميل الأدوار: ' + data.message); } } catch (error) { console.error('خطأ في تحميل الأدوار:', error); showAlert('error', 'حدث خطأ في تحميل الأدوار'); } finally { document.getElementById('roles-loading').style.display = 'none'; document.getElementById('roles-table-container').style.display = 'block'; } } // عرض الأدوار function displayRoles(roles) { const tbody = document.getElementById('roles-tbody'); tbody.innerHTML = ''; roles.forEach(role => { const usersCount = currentUsers.filter(user => user.role_id === role.id).length; const row = document.createElement('tr'); row.innerHTML = ` <td>${role.name}</td><td>${role.description || 'لا يوجد وصف'}</td><td>${usersCount}</td><td>${role.created_at ? new Date(role.created_at).toLocaleDateString('ar-EG') : 'غير محدد'}</td><td><button type="button" class="btn btn-warning" onclick="editRole(${role.id})" style="margin: 2px;"><i class="fas fa-edit"></i></button><button type="button" class="btn btn-danger" onclick="deleteRole(${role.id})" style="margin: 2px;"><i class="fas fa-trash"></i></button></td> `; tbody.appendChild(row); }); } // تحميل الصلاحيات المتاحة async function loadPermissions() { try { const response = await fetch('/api/permissions'); const data = await response.json(); if (data.success) { availablePermissions = data.data; updatePermissionsContainer(); } } catch (error) { console.error('خطأ في تحميل الصلاحيات:', error); } } // تحديث حاوية الصلاحيات function updatePermissionsContainer() { const container = document.getElementById('permissions-container'); container.innerHTML = ''; Object.entries(availablePermissions).forEach(([key, description]) => { const permissionItem = document.createElement('div'); permissionItem.className = 'permission-item'; permissionItem.innerHTML = ` <label><input type="checkbox" name="permission" value="${key}"><span>${description}</span></label> `; container.appendChild(permissionItem); }); } // تحديث قائمة الأدوار في نموذج المستخدم function updateRoleSelect(roles) { const select = document.getElementById('user-role'); select.innerHTML = '<option value="">اختر الدور</option>'; roles.forEach(role => { const option = document.createElement('option'); option.value = role.id; option.textContent = role.name; select.appendChild(option); }); } // إظهار نموذج المستخدم function showUserModal(userId = null) { editingUserId = userId; const modal = document.getElementById('user-modal'); const title = document.getElementById('user-modal-title'); const form = document.getElementById('user-form'); if (userId) { title.textContent = 'تعديل المستخدم'; const user = currentUsers.find(u => u.id === userId); if (user) { document.getElementById('user-username').value = user.username; document.getElementById('user-email').value = user.email; document.getElementById('user-full-name').value = user.full_name; document.getElementById('user-phone').value = user.phone || ''; document.getElementById('user-role').value = user.role_id || ''; document.getElementById('user-active').checked = user.is_active; document.getElementById('user-password').required = false; document.getElementById('user-password').placeholder = 'اتركه فارغاً للاحتفاظ بكلمة المرور الحالية'; } } else { title.textContent = 'إضافة مستخدم جديد'; form.reset(); document.getElementById('user-password').required = true; document.getElementById('user-password').placeholder = ''; document.getElementById('user-active').checked = true; } modal.style.display = 'block'; } // إغلاق نموذج المستخدم function closeUserModal() { document.getElementById('user-modal').style.display = 'none'; document.getElementById('user-alert').style.display = 'none'; editingUserId = null; } // إظهار نموذج الدور function showRoleModal(roleId = null) { editingRoleId = roleId; const modal = document.getElementById('role-modal'); const title = document.getElementById('role-modal-title'); const form = document.getElementById('role-form'); if (roleId) { title.textContent = 'تعديل الدور'; const role = currentRoles.find(r => r.id === roleId); if (role) { document.getElementById('role-name').value = role.name; document.getElementById('role-description').value = role.description || ''; // تحديد الصلاحيات const checkboxes = document.querySelectorAll('input[name="permission"]'); checkboxes.forEach(checkbox => { checkbox.checked = role.permissions && role.permissions[checkbox.value] === true; }); } } else { title.textContent = 'إضافة دور جديد'; form.reset(); // إلغاء تحديد جميع الصلاحيات const checkboxes = document.querySelectorAll('input[name="permission"]'); checkboxes.forEach(checkbox => { checkbox.checked = false; }); } modal.style.display = 'block'; } // إغلاق نموذج الدور function closeRoleModal() { document.getElementById('role-modal').style.display = 'none'; document.getElementById('role-alert').style.display = 'none'; editingRoleId = null; } // حفظ المستخدم document.getElementById('user-form').addEventListener('submit', async function(e) { e.preventDefault(); const formData = { username: document.getElementById('user-username').value, email: document.getElementById('user-email').value, full_name: document.getElementById('user-full-name').value, phone: document.getElementById('user-phone').value, role_id: parseInt(document.getElementById('user-role').value), is_active: document.getElementById('user-active').checked }; const password = document.getElementById('user-password').value; if (password) { formData.password = password; } try { const url = editingUserId ? `/api/users/${editingUserId}` : '/api/users'; const method = editingUserId ? 'PUT' : 'POST'; const response = await fetch(url, { method: method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(formData) }); const data = await response.json(); if (data.success) { showUserAlert('success', data.message); setTimeout(() => { closeUserModal(); loadUsers(); }, 1500); } else { showUserAlert('error', data.message); } } catch (error) { console.error('خطأ في حفظ المستخدم:', error); showUserAlert('error', 'حدث خطأ في حفظ المستخدم'); } }); // حفظ الدور document.getElementById('role-form').addEventListener('submit', async function(e) { e.preventDefault(); // جمع الصلاحيات المحددة const permissions = {}; const checkboxes = document.querySelectorAll('input[name="permission"]:checked'); checkboxes.forEach(checkbox => { permissions[checkbox.value] = true; }); const formData = { name: document.getElementById('role-name').value, description: document.getElementById('role-description').value, permissions: permissions }; try { const url = editingRoleId ? `/api/roles/${editingRoleId}` : '/api/roles'; const method = editingRoleId ? 'PUT' : 'POST'; const response = await fetch(url, { method: method, headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(formData) }); const data = await response.json(); if (data.success) { showRoleAlert('success', data.message); setTimeout(() => { closeRoleModal(); loadRoles(); }, 1500); } else { showRoleAlert('error', data.message); } } catch (error) { console.error('خطأ في حفظ الدور:', error); showRoleAlert('error', 'حدث خطأ في حفظ الدور'); } }); // تعديل المستخدم function editUser(userId) { showUserModal(userId); } // حذف المستخدم async function deleteUser(userId) { if (!confirm('هل أنت متأكد من حذف هذا المستخدم؟')) { return; } try { const response = await fetch(`/api/users/${userId}`, { method: 'DELETE' }); const data = await response.json(); if (data.success) { showAlert('success', data.message); loadUsers(); } else { showAlert('error', data.message); } } catch (error) { console.error('خطأ في حذف المستخدم:', error); showAlert('error', 'حدث خطأ في حذف المستخدم'); } } // تعديل الدور function editRole(roleId) { showRoleModal(roleId); } // حذف الدور async function deleteRole(roleId) { if (!confirm('هل أنت متأكد من حذف هذا الدور؟')) { return; } try { const response = await fetch(`/api/roles/${roleId}`, { method: 'DELETE' }); const data = await response.json(); if (data.success) { showAlert('success', data.message); loadRoles(); } else { showAlert('error', data.message); } } catch (error) { console.error('خطأ في حذف الدور:', error); showAlert('error', 'حدث خطأ في حذف الدور'); } } // تحميل نشاط المستخدمين async function loadUserActivity() { try { const [activityResponse, statsResponse] = await Promise.all([ fetch('/api/user-activity'), fetch('/api/system-stats') ]); const activityData = await activityResponse.json(); const statsData = await statsResponse.json(); if (activityData.success) { displayUserActivity(activityData.data); } if (statsData.success) { displaySystemStats(statsData.data); } } catch (error) { console.error('خطأ في تحميل نشاط المستخدمين:', error); } } // عرض نشاط المستخدمين function displayUserActivity(activity) { const tbody = document.getElementById('activity-tbody'); tbody.innerHTML = ''; activity.forEach(user => { const row = document.createElement('tr'); row.innerHTML = ` <td>${user.username}</td><td>${user.full_name}</td><td>${user.role_name || 'غير محدد'}</td><td>${user.last_login ? new Date(user.last_login).toLocaleDateString('ar-EG') : 'لم يدخل بعد'}</td><td><span class="status-badge status-active">نشط</span></td> `; tbody.appendChild(row); }); } // عرض إحصائيات النظام function displaySystemStats(stats) { const container = document.getElementById('activity-stats'); container.innerHTML = ` <div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 20px; border-radius: 10px; text-align: center;"><h4 style="color: #3498db; font-size: 1.8rem; margin-bottom: 5px;">${stats.total_users}</h4><p style="color: #6c757d; font-size: 0.9rem;">إجمالي المستخدمين</p></div><div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 20px; border-radius: 10px; text-align: center;"><h4 style="color: #2ecc71; font-size: 1.8rem; margin-bottom: 5px;">${stats.active_users}</h4><p style="color: #6c757d; font-size: 0.9rem;">المستخدمين النشطين</p></div><div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 20px; border-radius: 10px; text-align: center;"><h4 style="color: #e74c3c; font-size: 1.8rem; margin-bottom: 5px;">${stats.inactive_users}</h4><p style="color: #6c757d; font-size: 0.9rem;">المستخدمين غير النشطين</p></div><div style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); padding: 20px; border-radius: 10px; text-align: center;"><h4 style="color: #9b59b6; font-size: 1.8rem; margin-bottom: 5px;">${stats.total_roles}</h4><p style="color: #6c757d; font-size: 0.9rem;">إجمالي الأدوار</p></div> `; } // تحميل إحصائيات النظام async function loadSystemStats() { try { const response = await fetch('/api/system-stats'); const data = await response.json(); if (data.success) { displaySystemStats(data.data); } } catch (error) { console.error('خطأ في تحميل إحصائيات النظام:', error); } } // عرض التنبيهات function showAlert(type, message) { // يمكن تطوير هذا لاحقاً لعرض تنبيهات أفضل if (type === 'success') { alert('✅ ' + message); } else { alert('❌ ' + message); } } // عرض تنبيهات المستخدم function showUserAlert(type, message) { const alertDiv = document.getElementById('user-alert'); alertDiv.className = `alert alert-${type}`; alertDiv.textContent = message; alertDiv.style.display = 'block'; } // عرض تنبيهات الدور function showRoleAlert(type, message) { const alertDiv = document.getElementById('role-alert'); alertDiv.className = `alert alert-${type}`; alertDiv.textContent = message; alertDiv.style.display = 'block'; } // إغلاق النوافذ عند الضغط خارجها window.onclick = function(event) { const userModal = document.getElementById('user-modal'); const roleModal = document.getElementById('role-modal'); if (event.target === userModal) { closeUserModal(); } if (event.target === roleModal) { closeRoleModal(); } } </script></body></html> 