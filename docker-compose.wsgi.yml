services:
  api:
    build:
      context: .
      dockerfile: Dockerfile
    image: store-backend:1.6
    container_name: store_api
    ports:
      - "8000:8000"
    environment:
      - FLASK_ENV=production
    volumes:
      - ./backend:/app/backend:delegated
    command: >
      bash -lc "python -m pip install --upgrade pip &&
                if [ -f /app/backend/dev-requirements.txt ]; then pip install -r /app/backend/dev-requirements.txt; fi &&
                gunicorn -w 4 -b 0.0.0.0:8000 wsgi:app"

