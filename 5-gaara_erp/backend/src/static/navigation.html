<!-- ملف: /home/ubuntu/complete_inventory_system/backend/src/static/navigation.html --><!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>شريط التنقل - نظام إدارة المخزون</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"><link href="css/navigation.css" rel="stylesheet"></head><body><!-- Navigation Bar --><nav class="navbar navbar-expand-lg navbar-dark"><div class="container-fluid"><a class="navbar-brand" href="dashboard.html"><i class="fas fa-cubes"></i> نظام إدارة المخزون المتقدم </a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-label="تبديل القائمة" title="تبديل القائمة" ><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNav"><ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="dashboard.html"><i class="fas fa-tachometer-alt"></i> لوحة التحكم </a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="inventoryDropdown" role="button" tabindex="0" tabindex="0" data-bs-toggle="dropdown"><i class="fas fa-boxes"></i> إدارة المخزون </a><ul class="dropdown-menu"><li><a class="dropdown-item" href="inventory.html"><i class="fas fa-list"></i> قائمة الأصناف</a></li><li><a class="dropdown-item" href="batch_management.html"><i class="fas fa-tags"></i> إدارة اللوطات</a></li><li><a class="dropdown-item" href="warehouse_transfer.html"><i class="fas fa-exchange-alt"></i> نقل المخزون</a></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="regions.html"><i class="fas fa-map-marker-alt"></i> إدارة المناطق</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="salesDropdown" role="button" tabindex="0" tabindex="0" data-bs-toggle="dropdown"><i class="fas fa-shopping-cart"></i> المبيعات </a><ul class="dropdown-menu"><li><a class="dropdown-item" href="sales.html"><i class="fas fa-receipt"></i> فواتير المبيعات</a></li><li><a class="dropdown-item" href="sales_engineers.html"><i class="fas fa-user-tie"></i> مهندسي المبيعات</a></li><li><a class="dropdown-item" href="customers_advanced.html"><i class="fas fa-users"></i> إدارة العملاء</a></li><li><a class="dropdown-item" href="sales_reports.html"><i class="fas fa-chart-line"></i> تقارير المبيعات</a></li></ul></li><li class="nav-item"><a class="nav-link" href="purchases.html"><i class="fas fa-shopping-bag"></i> المشتريات </a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="accountingDropdown" role="button" tabindex="0" tabindex="0" data-bs-toggle="dropdown"><i class="fas fa-calculator"></i> المحاسبة </a><ul class="dropdown-menu"><li><a class="dropdown-item" href="accounting.html"><i class="fas fa-file-invoice-dollar"></i> النظام المحاسبي</a></li><li><a class="dropdown-item" href="financial_reports.html"><i class="fas fa-chart-pie"></i> التقارير المالية</a></li><li><a class="dropdown-item" href="currencies.html"><i class="fas fa-coins"></i> إدارة العملات</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="reportsDropdown" role="button" tabindex="0" tabindex="0" data-bs-toggle="dropdown"><i class="fas fa-chart-bar"></i> التقارير </a><ul class="dropdown-menu"><li><a class="dropdown-item" href="#" onclick="exportInventoryReport()"><i class="fas fa-file-excel"></i> تقرير المخزون</a></li><li><a class="dropdown-item" href="#" onclick="exportSalesReport()"><i class="fas fa-file-pdf"></i> تقرير المبيعات</a></li><li><a class="dropdown-item" href="#" onclick="exportPurchasesReport()"><i class="fas fa-file-csv"></i> تقرير المشتريات</a></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="#" onclick="showCustomReportModal()"><i class="fas fa-cog"></i> تقرير مخصص</a></li></ul></li></ul><ul class="navbar-nav"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="adminDropdown" role="button" tabindex="0" tabindex="0" data-bs-toggle="dropdown"><i class="fas fa-cog"></i> الإدارة </a><ul class="dropdown-menu"><li><a class="dropdown-item" href="admin_panel.html"><i class="fas fa-users-cog"></i> لوحة الإدارة</a></li><li><a class="dropdown-item" href="#" onclick="showImportModal()"><i class="fas fa-upload"></i> استيراد البيانات</a></li><li><a class="dropdown-item" href="#" onclick="showBackupModal()"><i class="fas fa-database"></i> النسخ الاحتياطي</a></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="#" onclick="showSettingsModal()"><i class="fas fa-cog"></i> الإعدادات</a></li></ul></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" tabindex="0" tabindex="0" data-bs-toggle="dropdown"><i class="fas fa-user"></i><span id="currentUserName">المستخدم</span></a><ul class="dropdown-menu"><li><a class="dropdown-item" href="#" onclick="showProfileModal()"><i class="fas fa-user-edit"></i> الملف الشخصي</a></li><li><a class="dropdown-item" href="#" onclick="showChangePasswordModal()"><i class="fas fa-key"></i> تغيير كلمة المرور</a></li><li><hr class="dropdown-divider"></li><li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> تسجيل الخروج</a></li></ul></li></ul></div></div></nav><!-- Import Data Modal --><div class="modal fade" id="importModal" tabindex="-1"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><h5 class="modal-title"><i class="fas fa-upload"></i> استيراد البيانات</h5><button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="إغلاق" title="إغلاق النافذة" ></button></div><div class="modal-body"><div class="row"><div class="col-md-6 mb-3"><div class="card"><div class="card-body text-center"><i class="fas fa-users fa-3x text-primary mb-3"></i><h5>استيراد العملاء</h5><p class="text-muted">استيراد قائمة العملاء من ملف Excel</p><button type="button" class="btn btn-primary" onclick="downloadTemplate('customers')"><i class="fas fa-download"></i> تحميل القالب </button><input type="file" id="customersFile" accept=".xlsx,.xls" style="display: none;"><button type="button" class="btn btn-success mt-2" onclick="document.getElementById('customersFile').click()"><i class="fas fa-upload"></i> رفع الملف </button></div></div></div><div class="col-md-6 mb-3"><div class="card"><div class="card-body text-center"><i class="fas fa-truck fa-3x text-success mb-3"></i><h5>استيراد الموردين</h5><p class="text-muted">استيراد قائمة الموردين من ملف Excel</p><button type="button" class="btn btn-primary" onclick="downloadTemplate('suppliers')"><i class="fas fa-download"></i> تحميل القالب </button><input type="file" id="suppliersFile" accept=".xlsx,.xls" style="display: none;"><button type="button" class="btn btn-success mt-2" onclick="document.getElementById('suppliersFile').click()"><i class="fas fa-upload"></i> رفع الملف </button></div></div></div><div class="col-md-6 mb-3"><div class="card"><div class="card-body text-center"><i class="fas fa-boxes fa-3x text-warning mb-3"></i><h5>استيراد الأصناف</h5><p class="text-muted">استيراد قائمة الأصناف مع الأرصدة</p><button type="button" class="btn btn-primary" onclick="downloadTemplate('products')"><i class="fas fa-download"></i> تحميل القالب </button><input type="file" id="productsFile" accept=".xlsx,.xls" style="display: none;"><button type="button" class="btn btn-success mt-2" onclick="document.getElementById('productsFile').click()"><i class="fas fa-upload"></i> رفع الملف </button></div></div></div><div class="col-md-6 mb-3"><div class="card"><div class="card-body text-center"><i class="fas fa-tags fa-3x text-info mb-3"></i><h5>استيراد اللوطات</h5><p class="text-muted">استيراد بيانات اللوطات ولوطات الوزارة</p><button type="button" class="btn btn-primary" onclick="downloadTemplate('batches')"><i class="fas fa-download"></i> تحميل القالب </button><input type="file" id="batchesFile" accept=".xlsx,.xls" style="display: none;"><button type="button" class="btn btn-success mt-2" onclick="document.getElementById('batchesFile').click()"><i class="fas fa-upload"></i> رفع الملف </button></div></div></div></div></div><div class="modal-footer"><button type="button" class="btn btn-secondary" data-bs-dismiss="modal">إغلاق</button></div></div></div></div><!-- Scripts --><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script><script src="js/navigation.js"></script><script> // تحميل اسم المستخدم الحالي document.addEventListener('DOMContentLoaded', function() { loadCurrentUser(); }); async function loadCurrentUser() { try { const response = await fetch('/api/user/current'); const result = await response.json(); if (result.success && result.user) { document.getElementById('currentUserName').textContent = result.user.full_name || 'المستخدم'; } } catch (error) { console.error('خطأ في تحميل بيانات المستخدم:', error); } } // وظائف التصدير function exportInventoryReport() { window.open('/api/reports/export/inventory', '_blank'); } function exportSalesReport() { window.open('/api/reports/export/sales', '_blank'); } function exportPurchasesReport() { window.open('/api/reports/export/purchases', '_blank'); } // وظائف الاستيراد function showImportModal() { const modal = new bootstrap.Modal(document.getElementById('importModal')); modal.show(); } async function downloadTemplate(type) { try { const response = await fetch(`/api/excel/templates/${type}`); const blob = await response.blob(); const url = window.URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = `template_${type}.xlsx`; document.body.appendChild(a); a.click(); window.URL.revokeObjectURL(url); document.body.removeChild(a); showAlert(`تم تحميل قالب ${getTypeDisplayName(type)} بنجاح`, 'success'); } catch (error) { console.error('خطأ في تحميل القالب:', error); showAlert('خطأ في تحميل القالب', 'danger'); } } function getTypeDisplayName(type) { const names = { 'customers': 'العملاء', 'suppliers': 'الموردين', 'products': 'الأصناف', 'batches': 'اللوطات' }; return names[type] || type; } // معالجة رفع الملفات document.getElementById('customersFile').addEventListener('change', function(e) { uploadFile(e.target.files[0], 'customers'); }); document.getElementById('suppliersFile').addEventListener('change', function(e) { uploadFile(e.target.files[0], 'suppliers'); }); document.getElementById('productsFile').addEventListener('change', function(e) { uploadFile(e.target.files[0], 'products'); }); document.getElementById('batchesFile').addEventListener('change', function(e) { uploadFile(e.target.files[0], 'batches'); }); async function uploadFile(file, type) { if (!file) return; const formData = new FormData(); formData.append('file', file); try { showAlert(`جاري رفع ملف ${getTypeDisplayName(type)}...`, 'info'); const response = await fetch(`/api/excel/import/${type}`, { method: 'POST', body: formData }); const result = await response.json(); if (result.success) { showAlert(`تم استيراد ${getTypeDisplayName(type)} بنجاح. تم إضافة ${result.imported_count} عنصر.`, 'success'); // إغلاق النافذة المنبثقة bootstrap.Modal.getInstance(document.getElementById('importModal')).hide(); // تحديث الصفحة إذا كانت ذات صلة if (window.location.pathname.includes(type) || window.location.pathname.includes('dashboard')) { setTimeout(() => { window.location.reload(); }, 2000); } } else { showAlert(`خطأ في استيراد ${getTypeDisplayName(type)}: ${result.message}`, 'danger'); } } catch (error) { console.error('خطأ في رفع الملف:', error); showAlert('خطأ في رفع الملف', 'danger'); } } // وظائف أخرى function showCustomReportModal() { showAlert('سيتم تطوير التقارير المخصصة قريباً', 'info'); } function showBackupModal() { showAlert('سيتم تطوير إدارة النسخ الاحتياطي قريباً', 'info'); } function showSettingsModal() { showAlert('سيتم تطوير الإعدادات قريباً', 'info'); } function showProfileModal() { showAlert('سيتم تطوير إدارة الملف الشخصي قريباً', 'info'); } function showChangePasswordModal() { showAlert('سيتم تطوير تغيير كلمة المرور قريباً', 'info'); } function logout() { if (confirm('هل أنت متأكد من تسجيل الخروج؟')) { window.location.href = 'index.html'; } } // عرض التنبيهات function showAlert(message, type = 'info') { const alertDiv = document.createElement('div'); alertDiv.className = `alert alert-${type} alert-dismissible fade show position-fixed`; alertDiv.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;'; alertDiv.innerHTML = ` ${message} <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="إغلاق" title="إغلاق النافذة" ></button> `; document.body.appendChild(alertDiv); // إزالة التنبيه تلقائياً بعد 5 ثوان setTimeout(() => { if (alertDiv.parentNode) { alertDiv.remove(); } }, 5000); } </script></body></html> 