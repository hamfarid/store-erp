# =============================================================================
# PRODUCTION ENVIRONMENT CONFIGURATION
# =============================================================================
# FILE: backend/env.production.template
# PURPOSE: P0.21 Production environment template with KMS references
# SECURITY: NEVER commit real secrets. Use this template to create .env.production
# =============================================================================

# -----------------------------------------------------------------------------
# FLASK CONFIGURATION
# -----------------------------------------------------------------------------
FLASK_ENV=production
FLASK_DEBUG=0
FLASK_APP=src.main:app

# -----------------------------------------------------------------------------
# SECRETS (Use KMS/Vault References)
# -----------------------------------------------------------------------------
# Option 1: AWS KMS
# SECRET_KEY=aws-kms://alias/store-app/secret-key
# JWT_SECRET_KEY=aws-kms://alias/store-app/jwt-secret

# Option 2: HashiCorp Vault
# SECRET_KEY=vault://secret/data/store-app#secret_key
# JWT_SECRET_KEY=vault://secret/data/store-app#jwt_secret_key

# Option 3: Azure Key Vault
# SECRET_KEY=azure-keyvault://store-vault/secret-key
# JWT_SECRET_KEY=azure-keyvault://store-vault/jwt-secret-key

# Option 4: Environment Variables (minimum security - use in containers with secrets mounted)
# Generate with: openssl rand -base64 32
SECRET_KEY=${SECRET_KEY}
JWT_SECRET_KEY=${JWT_SECRET_KEY}

# -----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# -----------------------------------------------------------------------------
# Option 1: Connection string with credentials from KMS
# DATABASE_URL=aws-kms://alias/store-app/database-url

# Option 2: Standard PostgreSQL connection
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

# SQLite (NOT for production - development only)
# SQLALCHEMY_DATABASE_URI=sqlite:///instance/inventory.db

# Database pool settings
SQLALCHEMY_POOL_SIZE=10
SQLALCHEMY_POOL_TIMEOUT=30
SQLALCHEMY_MAX_OVERFLOW=20

# -----------------------------------------------------------------------------
# REDIS CONFIGURATION (for rate limiting, sessions, cache)
# -----------------------------------------------------------------------------
REDIS_URL=redis://:${REDIS_PASSWORD}@${REDIS_HOST}:6379/0
RATELIMIT_STORAGE_URL=${REDIS_URL}

# -----------------------------------------------------------------------------
# JWT CONFIGURATION
# -----------------------------------------------------------------------------
JWT_ACCESS_TTL_MIN=15
JWT_REFRESH_TTL_DAYS=7
JWT_ALGORITHM=HS256

# -----------------------------------------------------------------------------
# CORS CONFIGURATION
# -----------------------------------------------------------------------------
# Comma-separated list of allowed origins
CORS_ORIGINS=https://store.example.com,https://admin.example.com

# -----------------------------------------------------------------------------
# SESSION CONFIGURATION
# -----------------------------------------------------------------------------
SESSION_TYPE=redis
SESSION_PERMANENT=false
SESSION_USE_SIGNER=true
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax

# -----------------------------------------------------------------------------
# SECURITY CONFIGURATION
# -----------------------------------------------------------------------------
# Rate limiting
RATELIMIT_DEFAULT=100/minute
RATELIMIT_STORAGE_URL=${REDIS_URL}

# CSRF
WTF_CSRF_ENABLED=true
WTF_CSRF_TIME_LIMIT=3600

# Password hashing
ARGON2_TIME_COST=3
ARGON2_MEMORY_COST=65536
ARGON2_PARALLELISM=4

# -----------------------------------------------------------------------------
# LOGGING CONFIGURATION
# -----------------------------------------------------------------------------
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=/var/log/store-app/app.log

# Security logging
SECURITY_LOG_FILE=/var/log/store-app/security.log
AUDIT_LOG_ENABLED=true

# -----------------------------------------------------------------------------
# MONITORING (Optional)
# -----------------------------------------------------------------------------
# SENTRY_DSN=https://xxx@sentry.io/xxx
# NEW_RELIC_LICENSE_KEY=xxx

# -----------------------------------------------------------------------------
# EMAIL CONFIGURATION (Optional)
# -----------------------------------------------------------------------------
# MAIL_SERVER=smtp.example.com
# MAIL_PORT=587
# MAIL_USE_TLS=true
# MAIL_USERNAME=${MAIL_USERNAME}
# MAIL_PASSWORD=${MAIL_PASSWORD}

# -----------------------------------------------------------------------------
# BACKUP CONFIGURATION
# -----------------------------------------------------------------------------
BACKUP_ENABLED=true
BACKUP_RETENTION_DAYS=30
# BACKUP_S3_BUCKET=store-backups

# =============================================================================
# DEPLOYMENT NOTES
# =============================================================================
# 
# 1. Copy this file to .env.production and fill in actual values
# 2. NEVER commit .env.production to version control
# 3. Use a secrets manager in production:
#    - AWS: AWS Secrets Manager or Parameter Store
#    - GCP: Secret Manager
#    - Azure: Key Vault
#    - Self-hosted: HashiCorp Vault
#
# 4. For Kubernetes deployments, use:
#    - Kubernetes Secrets
#    - External Secrets Operator
#    - Sealed Secrets
#
# 5. Rotate secrets regularly:
#    - SECRET_KEY: Every 90 days
#    - JWT_SECRET_KEY: Every 90 days
#    - Database passwords: Every 90 days
#
# =============================================================================

