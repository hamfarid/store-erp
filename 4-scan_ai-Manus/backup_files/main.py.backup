# File: /home/ubuntu/ai_web_organized_final/src/main.py
""

Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚
ÙŠÙ‚ÙˆÙ… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ø¨ØªØ¬Ù…ÙŠØ¹ Ø¬Ù…ÙŠØ¹ ÙˆØ­Ø¯Ø§Øª API Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„ÙØ±Ø¹ÙŠØ© ÙˆØªÙˆÙÙŠØ± Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ©
Ù…ÙˆØ­Ø¯Ø© Ù„Ù„ØªØ·Ø¨ÙŠÙ‚
""

import os
import sys
import logging
import uvicorn
from datetime import datetime
from fastapi import FastAPI, Request
from fastapi.middleware.cors import CORSMiddleware
from fastapi.responses import JSONResponse, HTMLResponse, RedirectResponse

from typing import Dict

# Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¥Ù„Ù‰ sys.path Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ø³ØªÙŠØ±Ø§Ø¯ src
current_dir = os.path.dirname(os.path.abspath(__file__))
parent_dir = os.path.dirname(current_dir)
if parent_dir not in sys.path:
    sys.path.insert(0, parent_dir)

# Constants
SYSTEM_NAME = Ù†Ø¸Ø§Ù… Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©""
SYSTEM_VERSION = "1.0.0"
SYSTEM_DESCRIPTION = "Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ø°ÙƒÙŠØ© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ"

# Template placeholders
 placeholder=_SYSTEM_NAME = '{system_name}'
 placeholder=_SYSTEM_VERSION = '{system_version}'
 placeholder=_USERNAME_VALUE = '{username_value}'
 placeholder=_PASSWORD_VALUE = '{password_value}'

# Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
logging.basicConfig(
    level=logging.INFO,
    format="%(asctime)s | %(message)s",
    datefmt="%Y-%m-%d %H:%M:%S, ",
)
logger = logging.getLogger(__name__)

# Ø¥Ù†Ø´Ø§Ø¡ ØªØ·Ø¨ÙŠÙ‚ FastAPI
app = FastAPI(
    title=SYSTEM_NAME,
    description=(
        f"ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ù„{SYSTEM_NAME} Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ Ø¹Ù„Ù‰"
        " Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ"
    ),
    version=SYSTEM_VERSION,
)

# Ø¥Ø¶Ø§ÙØ© CORS middleware
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],  # ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù„ØªÙ‚ÙŠÙŠØ¯ Ø§Ù„ÙˆØµÙˆÙ„ ÙÙŠ Ø¨ÙŠØ¦Ø© Ø§Ù„Ø¥Ù†ØªØ§Ø¬
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)

# Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©
AVAILABLE_MODULES = []


# Ø¯Ø§Ù„Ø© Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†
def load_module_safely(module_path: str, module_name: str, router_name: str = "router"):
    "ØªØ­Ù…ÙŠÙ„ Ù…Ø¯ÙŠÙˆÙ„ Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù† Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø£Ø®Ø·Ø§Ø¡"""
    try:
        module = __import__(module_path, fromlist=[router_name])
        router = getattr(module, router_name)
        app.include_router(router)
        AVAILABLE_MODULES.append({
            nameMODULE_NAMEpathMODULE_PATHstatus": "loaded"error: None"
        })
        logger.info(f"âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ {module_name} Ø¨Ù†Ø¬Ø§Ø­")
        return True
    except ImportError as e:
        AVAILABLE_MODULES.append({
            "nameMODULE_NAMEpathMODULE_PATHstatus": "failed"error: f", ImportError: {str(e)}"
        })
        logger.warning(f"âš ï¸ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ {module_name}: {str(e)}")
        return False
    except AttributeError as e:
        AVAILABLE_MODULES.append({
            "nameMODULE_NAMEpathMODULE_PATHstatus": "failed"error: f", AttributeError: {str(e)}"
        })
        logger.warning(f"âš ï¸ ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ {module_name}: {str(e)}")
        return False
    except Exception as e:
        AVAILABLE_MODULES.append({
            "nameMODULE_NAMEpathMODULE_PATHstatus": "failed"error: f", Exception: {str(e)}"
        })
        logger.error(f"âŒ Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹ ÙÙŠ ØªØ­Ù…ÙŠÙ„ {module_name}: {str(e)}")
        return False


# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª
logger.info("ğŸ”„ Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ù…Ø¯ÙŠÙˆÙ„Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…...")

# Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
load_module_safely("src.modules.data_validation.api", "ÙˆØ­Ø¯Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª", "routerLOAD_MODULE_SAFELYsrc.modules.auth.api", "ÙˆØ­Ø¯Ø© Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©", "routerLOAD_MODULE_SAFELYsrc.modules.backup_restore.api", "ÙˆØ­Ø¯Ø© Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ ÙˆØ§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©", "routerLOAD_MODULE_SAFELYsrc.modules.settings.api", "ÙˆØ­Ø¯Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª", "routerLOAD_MODULE_SAFELYsrc.modules.setup_wizard.api", "ÙˆØ­Ø¯Ø© Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯", "router")

# Ù…Ø¯ÙŠÙˆÙ„Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
load_module_safely("src.modules.ai_management.api", "ÙˆØ­Ø¯Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ", "routerLOAD_MODULE_SAFELYsrc.modules.disease_diagnosis.api", "ÙˆØ­Ø¯Ø© ØªØ´Ø®ÙŠØµ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶", "routerLOAD_MODULE_SAFELYsrc.modules.image_processing.api", "ÙˆØ­Ø¯Ø© Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±", "routerLOAD_MODULE_SAFELYsrc.modules.plant_hybridization.api", "ÙˆØ­Ø¯Ø© ØªÙ‡Ø¬ÙŠÙ† Ø§Ù„Ù†Ø¨Ø§ØªØ§Øª", "router")

# Ù…Ø¯ÙŠÙˆÙ„Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØ§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
load_module_safely("src.modules.module_management.api", "ÙˆØ­Ø¯Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ÙˆØ­Ø¯Ø§Øª", "routerLOAD_MODULE_SAFELYsrc.modules.resource_monitoring.api", "ÙˆØ­Ø¯Ø© Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…ÙˆØ§Ø±Ø¯", "routerLOAD_MODULE_SAFELYsrc.modules.alert_management.api", "ÙˆØ­Ø¯Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª", "routerLOAD_MODULE_SAFELYsrc.modules.ai_usage_reports.api", "ÙˆØ­Ø¯Ø© ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ", "router")

# Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„
loaded_count = len([m for m in AVAILABLE_MODULES if m["status"] == "loaded"])
failed_count = len([m for m in AVAILABLE_MODULES if m["status"] == "failed"])
total_count = len(AVAILABLE_MODULES)

logger.info("ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª:LOGGERINFOF   âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„: {loaded_count}/{total_count}LOGGERINFOF   âŒ ÙØ´Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„: {failed_count}/{total_count}LOGGERINFOF   ğŸ“ˆ Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: {(loaded_count/total_count)*100:.1f}%")


# Ù†Ù‚Ø§Ø· Ù†Ù‡Ø§ÙŠØ© Ù„Ù„Ù†Ø¸Ø§Ù…
@app.get("/health")
async def health_check():
    "ÙØ­Øµ ØµØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù…"", RETURNstatus": "healthy"timestamp: datetime.now().isoformat(),
    }
        "modules"total: len(AVAILABLE_MODULES),
            "loadedLENM_FOR_Mstatus"] == "loaded"failedLENM_FOR_Mstatus] == "failed"])
        },
        "version": "1.0.0"
    }


@app.get("/api/modules/status")
async def get_modules_status():
    "Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª"", return {"
        "modules": AVAILABLE_MODULES,
        "summary"total: len(AVAILABLE_MODULES),
            "loadedLENM_FOR_Mstatus"] == "loaded"failedLENM_FOR_Mstatus] == "failed"success_rate: (len([m for m in AVAILABLE_MODULES if m["status"] == "loaded"]) / len(AVAILABLE_MODULES) * 100) if AVAILABLE_MODULES else 0
        },
        "timestamp": datetime.now().isoformat()
    }


@app.get("/api/info")
async def get_system_info():
    "Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…"", RETURNname": SYSTEM_NAME,
    }
        "version": SYSTEM_VERSION,
        "description": SYSTEM_DESCRIPTION,
        "modules": len(AVAILABLE_MODULES),
        "status": "running"timestamp: datetime.now().isoformat()
    }


# Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
@app.get("/login", response_class=HTMLResponse)
async def login_page(username: str = ", password: str = "):
    "Ø´Ø§Ø´Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù„Ù†Ø¸Ø§Ù… Ù…Ø¹ Ø¯Ø¹Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª URL, """
    username_value = username or 'admin'
    password_value = password or 'admin123'

    # Create HTML with proper CSS (no double braces)
    html = ", <!DOCTYPE html>"
<htmlar" dir="rtl<head>
    <meta charset=UTF-8<meta name=viewport" content=width=device-width, initial-scale=10>"
        <title>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ - {SYSTEM_NAME}</title>
        <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
            }
            .login-container {
                background: rgba(255, 255, 255, 0.1);
                padding: 3rem;
                border-radius: 20px;
                backdrop-filter: blur(10px);
                box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
                border: 1px solid rgba(255, 255, 255, 0.18);
                max-width: 400px;
                width: 90%;
                text-align: center;
            }
            h1 {
                font-size: 2rem;
                margin-bottom: 1rem;
                color: #fff;
            }
            .form-group {
                margin: 1.5rem 0;
                text-align: right;
            }
            label {
                display: block;
                margin-bottom: 0.5rem;
                font-weight: 500;
            }
            input {
                width: 100%;
                padding: 0.8rem;
                border: none;
                border-radius: 10px;
                background: rgba(255, 255, 255, 0.2);
                color: white;
                font-size: 1rem;
            }
            input::placeholder {
                color: rgba(255, 255, 255, 0.7);
            }
            .btn {
                background: #4CAF50;
                color: white;
                border: none;
                padding: 1rem 2rem;
                border-radius: 25px;
                cursor: pointer;
                font-size: 1rem;
                width: 100%;
                transition: all 0.3s;
                margin: 1rem 0;
            }
            .btn:hover {
                background: #45a049;
                transform: translateY(-2px);
            }
            .guest-btn {
                background: rgba(255, 255, 255, 0.2);
            }
            .guest-btn:hover {
                background: rgba(255, 255, 255, 0.3);
            }
            .footer {
                margin-top: 2rem;
                opacity: 0.8;
                font-size: 0.9rem;
            }
            .admin-info {
                background: rgba(255, 255, 255, 0.1);
                padding: 1.5rem;
                border-radius: 10px;
                margin: 1.5rem 0;
                border: 1px solid rgba(255, 255, 255, 0.2);
                text-align: center;
            }
            .admin-info h4 {
                color: #4CAF50;
                margin-bottom: 1rem;
                font-size: 1.1rem;
            }
            .admin-info p {
                margin: 0.5rem 0;
                font-size: 1rem;
            }
            .admin-info small {
                opacity: 0.8;
                font-style: italic;
            }
        </style>
    </head>
    <body>
        <div class="login-container">
            <h1>ğŸŒ± {SYSTEM_NAME}</h1>
            <p>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ù†Ø¸Ø§Ù…</p>

            <form onsubmit="handleLogin(event)<div class=form-group<label for=username">Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
                    <input type="text" id="username" name="username placeholder=Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" value="{username_value}" required>
                </div>
                <div class="form-group<label for=password">ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</label>
                    <input type="password" id="password" name="password placeholder=Ø£Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" value="{password_value}" required>
                </div>
                <button type="submit" class="btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            </form>

            <div class="admin-info">
                <h4>ğŸ”‘ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¯Ù…Ù† Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ©:</h4>
                <p><strong>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</strong> admin</p>
                <p><strong>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±:</strong> admin123</p>
                <small>ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</small>
            </div>

            <div class="footer">
                <p>Ø§Ù„Ø¥ØµØ¯Ø§Ø± {SYSTEM_VERSION} | {SYSTEM_NAME}</p>
            </div>
        </div>

        <script>
            function handleLogin(event) {
                event.preventDefault();
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;

                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¥Ø¯Ù…Ù†
                if (username === 'admin' && password === 'admin123') {
                    localStorage.setItem('user', JSON.stringify({
                        username: username,
                        role: 'admin',
                        loginTime: new Date().toISOString()
                    }));
                    // Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© Ø¨Ø¹Ø¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù†Ø§Ø¬Ø­
                    window.location.href = '/admin';
                } else {
                    alert('âŒ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©!\\n\\nØ§Ø³ØªØ®Ø¯Ù…:\\nØ§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: admin\\nÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±: admin123');
                }
            }
        </script>
    </body>
    </html>
    ""
    return html.replace('{SYSTEM_NAME}', SYSTEM_NAME).replace('{SYSTEM_VERSION}', SYSTEM_VERSION).replace('{username_value}', username_value).replace('{password_value}', password_value)


@app.post("/api/login")
async def api_login(username: str, password: str):
    ", API Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„"""
    if username == admin" and password == "admin123":"
        return {
            "success": True,
            "message": "ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­"user: {
                "username": username,
                "role": "admin",
                "loginTime": datetime.now().isoformat()
            },
            "redirect": "/admin"
        }
    else:
        return {
            "success": False,
            "message": "Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©"
        }


@app.get("/auto-login")
async def auto_login(username: str = "admin", password: str = "admin123"):
    "ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡"""
    if username == admin" and password == "admin123":"
        # Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        return RedirectResponse(url="/admin", status_code=302)
    else:
        # Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù…Ø¹ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£
        return RedirectResponse(url="/login", status_code=302)


# Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ø´Ø§Ø´Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
@app.get("/setup", response_class=HTMLResponse)
async def setup_page():
    "Ø´Ø§Ø´Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ© Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…"", HTML, "<!DOCTYPE html>
<htmlar" dir="rtl<head>
    <meta charset=UTF-8<meta name=viewport" content=width=device-width, initial-scale=10>"
        <title>Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù… - {SYSTEM_NAME}</title>
        <style>
            * {{ margin: 0; padding: 0; box-sizing: border-box; }}
            body {{
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                color: white;
            }}
            .setup-container {{
                max-width: 800px;
                margin: 2rem auto;
                padding: 2rem;
                background: rgba(255, 255, 255, 0.1);
                border-radius: 20px;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.18);
            }}
            .step {{
                display: none;
            }}
            .step.active {{
                display: block;
            }}
            .step-header {{
                text-align: center;
                margin-bottom: 2rem;
            }}
            .form-group {{
                margin: 1.5rem 0;
            }}
            label {{
                display: block;
                margin-bottom: 0.5rem;
                font-weight: 500;
            }}
            input, select, textarea {{
                width: 100%;
                padding: 0.8rem;
                border: none;
                border-radius: 10px;
                background: rgba(255, 255, 255, 0.2);
                color: white;
                font-size: 1rem;
            }}
            input::placeholder, textarea::placeholder {{
                color: rgba(255, 255, 255, 0.7);
            }}
            .btn {{
                background: #4CAF50;
                color: white;
                border: none;
                padding: 1rem 2rem;
                border-radius: 25px;
                cursor: pointer;
                font-size: 1rem;
                margin: 0.5rem;
            }}
            .btn:hover {{
                background: #45a049;
            }}
            .btn-secondary {{
                background: #ff9800;
            }}
            .btn-secondary:hover {{
                background: #f57c00;
            }}
            .progress-bar {{
                width: 100%;
                height: 10px;
                background: rgba(255,255,255,0.2);
                border-radius: 5px;
                margin-bottom: 2rem;
            }}
            .progress {{
                height: 100%;
                background: #4CAF50;
                border-radius: 5px;
                transition: width 0.3s;
            }}
            .module-item {{
                background: rgba(255,255,255,0.1);
                padding: 1rem;
                border-radius: 10px;
                margin: 0.5rem 0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }}
            .status-indicator {{
                width: 10px;
                height: 10px;
                border-radius: 50%;
                margin-left: 0.5rem;
            }}
            .status-success {{
                background: #4CAF50;
            }}
            .status-error {{
                background: #f44336;
            }}
            .status-pending {{
                background: #ff9800;
            }}
        </style>
    </head>
    <body>
        <div class="setup-container">
            <h1 style="text-align: center; margin-bottom: 2rem;">ğŸŒ± Ø¥Ø¹Ø¯Ø§Ø¯ {SYSTEM_NAME}</h1>

            <div class="progress-bar<div class=progress" id="progress" style="width: 20%;"></div>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 1: Ù…Ø±Ø­Ø¨Ø§Ù‹ -->
            <div class="step active" id="step1<div class=step-header">
                    <h2>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ {SYSTEM_NAME}</h2>
                    <p>Ø³Ù†Ù‚ÙˆÙ… Ø¨Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ø®Ø·ÙˆØ© Ø¨Ø®Ø·ÙˆØ©</p>
                </div>
                <button class="btn" onclick=nextStep()>Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯</button>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 2: Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø© -->
            <div class="step" id="step2<div class=step-header">
                    <h2>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¤Ø³Ø³Ø©</h2>
                    <p>Ø£Ø¯Ø®Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…Ø¤Ø³Ø³ØªÙƒ Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©</p>
                </div>
                <div class="form-group<label for=org-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø¤Ø³Ø³Ø©:</label>
                    <input type="text" id="org-name placeholder=Ù…Ø«Ø§Ù„: Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ø®ÙŠØ± Ø§Ù„Ø²Ø±Ø§Ø¹ÙŠØ©DIV_<div class=form-group<label for=org-type">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©:</label>
                    <select id="org-type<option value=, ">Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…Ø¤Ø³Ø³Ø©</option>
                        <option value="farm">Ù…Ø²Ø±Ø¹Ø© ÙØ±Ø¯ÙŠØ©</option>
                        <option value="company">Ø´Ø±ÙƒØ© Ø²Ø±Ø§Ø¹ÙŠØ©</option>
                        <option value="cooperative">ØªØ¹Ø§ÙˆÙ†ÙŠØ© Ø²Ø±Ø§Ø¹ÙŠØ©</option>
                        <option value="research">Ù…Ø¤Ø³Ø³Ø© Ø¨Ø­Ø«ÙŠØ©</option>
                    </select>
                </div>
                <div class="form-group<label for=country">Ø§Ù„Ø¯ÙˆÙ„Ø©:</label>
                    <select id="country" onchange="updateCities()<option value=, ">Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø©</option>
                        <optgroup label="Ø§Ù„Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©<option value=saudi">Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ù…ØµØ± Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                            <option value="uae">Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©</option>
                            <option value="egypt">Ù…ØµØ±</option>
                            <option value="jordan">Ø§Ù„Ø£Ø±Ø¯Ù†</option>
                            <option value="lebanon">Ù„Ø¨Ù†Ø§Ù†</option>
                            <option value="syria">Ø³ÙˆØ±ÙŠØ§</option>
                            <option value="iraq">Ø§Ù„Ø¹Ø±Ø§Ù‚</option>
                            <option value="kuwait">Ø§Ù„ÙƒÙˆÙŠØª</option>
                            <option value="qatar">Ù‚Ø·Ø±</option>
                            <option value="bahrain">Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†</option>
                            <option value="oman">Ø¹ÙÙ…Ø§Ù†</option>
                            <option value="yemen">Ø§Ù„ÙŠÙ…Ù†</option>
                            <option value="morocco">Ø§Ù„Ù…ØºØ±Ø¨</option>
                            <option value="algeria">Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±</option>
                            <option value="tunisia">ØªÙˆÙ†Ø³</option>
                            <option value="libya">Ù„ÙŠØ¨ÙŠØ§</option>
                            <option value="sudan">Ø§Ù„Ø³ÙˆØ¯Ø§Ù†</option>
                            <option value="palestine">ÙÙ„Ø³Ø·ÙŠÙ†</option>
                        </optgroup>
                        <optgroup label="Ø¯ÙˆÙ„ Ø¢Ø³ÙŠØ§<option value=turkey">ØªØ±ÙƒÙŠØ§</option>
                            <option value="india">Ø§Ù„Ù‡Ù†Ø¯</option>
                            <option value="thailand">ØªØ§ÙŠÙ„Ø§Ù†Ø¯</option>
                            <option value="china">Ø§Ù„ØµÙŠÙ†</option>
                            <option value="japan">Ø§Ù„ÙŠØ§Ø¨Ø§Ù†</option>
                            <option value="south_korea">ÙƒÙˆØ±ÙŠØ§ Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ©</option>
                            <option value="indonesia">Ø¥Ù†Ø¯ÙˆÙ†ÙŠØ³ÙŠØ§</option>
                            <option value="malaysia">Ù…Ø§Ù„ÙŠØ²ÙŠØ§</option>
                            <option value="singapore">Ø³Ù†ØºØ§ÙÙˆØ±Ø©</option>
                            <option value="philippines">Ø§Ù„ÙÙ„Ø¨ÙŠÙ†</option>
                            <option value="vietnam">ÙÙŠØªÙ†Ø§Ù…</option>
                            <option value="pakistan">Ø¨Ø§ÙƒØ³ØªØ§Ù†</option>
                            <option value="bangladesh">Ø¨Ù†ØºÙ„Ø§Ø¯ÙŠØ´</option>
                            <option value="sri_lanka">Ø³Ø±ÙŠÙ„Ø§Ù†ÙƒØ§</option>
                            <option value="iran">Ø¥ÙŠØ±Ø§Ù†</option>
                            <option value="afghanistan">Ø£ÙØºØ§Ù†Ø³ØªØ§Ù†</option>
                        </optgroup>
                        <optgroup label="Ø¯ÙˆÙ„ Ø£ÙˆØ±ÙˆØ¨Ø§<option value=uk">Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù…ØªØ­Ø¯Ø© (Ø¥Ù†Ø¬Ù„ØªØ±Ø§)</option>
                            <option value="germany">Ø£Ù„Ù…Ø§Ù†ÙŠØ§</option>
                            <option value="france">ÙØ±Ù†Ø³Ø§</option>
                            <option value="italy">Ø¥ÙŠØ·Ø§Ù„ÙŠØ§</option>
                            <option value="spain">Ø¥Ø³Ø¨Ø§Ù†ÙŠØ§</option>
                            <option value="netherlands">Ù‡ÙˆÙ„Ù†Ø¯Ø§</option>
                            <option value="belgium">Ø¨Ù„Ø¬ÙŠÙƒØ§</option>
                            <option value="switzerland">Ø³ÙˆÙŠØ³Ø±Ø§</option>
                            <option value="austria">Ø§Ù„Ù†Ù…Ø³Ø§</option>
                            <option value="sweden">Ø§Ù„Ø³ÙˆÙŠØ¯</option>
                            <option value="norway">Ø§Ù„Ù†Ø±ÙˆÙŠØ¬</option>
                            <option value="denmark">Ø§Ù„Ø¯Ù†Ù…Ø§Ø±Ùƒ</option>
                            <option value="finland">ÙÙ†Ù„Ù†Ø¯Ø§</option>
                            <option value="poland">Ø¨ÙˆÙ„Ù†Ø¯Ø§</option>
                            <option value="russia">Ø±ÙˆØ³ÙŠØ§</option>
                        </optgroup>
                        <optgroup label="Ø¯ÙˆÙ„ Ø£ÙØ±ÙŠÙ‚ÙŠØ§<option value=south_africa">Ø¬Ù†ÙˆØ¨ Ø£ÙØ±ÙŠÙ‚ÙŠØ§</option>
                            <option value="nigeria">Ù†ÙŠØ¬ÙŠØ±ÙŠØ§</option>
                            <option value="kenya">ÙƒÙŠÙ†ÙŠØ§</option>
                            <option value="ethiopia">Ø¥Ø«ÙŠÙˆØ¨ÙŠØ§</option>
                            <option value="ghana">ØºØ§Ù†Ø§</option>
                            <option value="tanzania">ØªÙ†Ø²Ø§Ù†ÙŠØ§</option>
                            <option value="uganda">Ø£ÙˆØºÙ†Ø¯Ø§</option>
                            <option value="zimbabwe">Ø²ÙŠÙ…Ø¨Ø§Ø¨ÙˆÙŠ</option>
                        </optgroup>
                        <optgroup label="Ø¯ÙˆÙ„ Ø£Ù…Ø±ÙŠÙƒØ§<option value=usa">Ø§Ù„ÙˆÙ„Ø§ÙŠØ§Øª Ø§Ù„Ù…ØªØ­Ø¯Ø©</option>
                            <option value="canada">ÙƒÙ†Ø¯Ø§</option>
                            <option value="mexico">Ø§Ù„Ù…ÙƒØ³ÙŠÙƒ</option>
                            <option value="brazil">Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„</option>
                            <option value="argentina">Ø§Ù„Ø£Ø±Ø¬Ù†ØªÙŠÙ†</option>
                            <option value="chile">ØªØ´ÙŠÙ„ÙŠ</option>
                            <option value="colombia">ÙƒÙˆÙ„ÙˆÙ…Ø¨ÙŠØ§</option>
                            <option value="peru">Ø¨ÙŠØ±Ùˆ</option>
                        </optgroup>
                        <optgroup label="Ø¯ÙˆÙ„ Ø£ÙˆÙ‚ÙŠØ§Ù†ÙˆØ³ÙŠØ§<option value=australia">Ø£Ø³ØªØ±Ø§Ù„ÙŠØ§</option>
                            <option value="new_zealand">Ù†ÙŠÙˆØ²ÙŠÙ„Ù†Ø¯Ø§</option>
                        </optgroup>
                    </select>
                </div>
                <div class="form-group<label for=city">Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©:</label>
                    <select id="city" disabled>
                        <option value=">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø£ÙˆÙ„Ø§Ù‹</option>"
                    </select>
                </div>
                <button class=btn btn-secondary onclick=prevStep()>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                <button class=btn" onclick=nextStep()>Ø§Ù„ØªØ§Ù„ÙŠ</button>"
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 3: Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª -->
            <div class="step" id="step3<div class=step-header">
                    <h2>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª</h2>
                    <p>Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ ØªÙØ¹ÙŠÙ„Ù‡Ø§</p>
                </div>
                <div id="modules-list">
                    <div class=module-item>
                        <div>
                            <strong>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</strong>
                            <p>Ø¥Ø¯Ø§Ø±Ø© Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</p>
                        </div>
                        <input type="checkbox" id="ai_management" checked>
                    </div>
                    <div class=module-item>
                        <div>
                            <strong>Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±</strong>
                            <p>ØªØ­Ù„ÙŠÙ„ ØµÙˆØ± Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„</p>
                        </div>
                        <input type="checkbox" id="image_processing" checked>
                    </div>
                    <div class=module-item>
                        <div>
                            <strong>ØªØ´Ø®ÙŠØµ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶</strong>
                            <p>ØªØ´Ø®ÙŠØµ Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù†Ø¨Ø§ØªØ§Øª</p>
                        </div>
                        <input type="checkbox" id="disease_diagnosis" checked>
                    </div>
                    <div class=module-item>
                        <div>
                            <strong>ØªÙ‡Ø¬ÙŠÙ† Ø§Ù„Ù†Ø¨Ø§ØªØ§Øª</strong>
                            <p>Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªÙ‡Ø¬ÙŠÙ†</p>
                        </div>
                        <input type="checkbox" id="plant_hybridization">
                    </div>
                </div>
                <button class=btn btn-secondary onclick=prevStep()>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                <button class="btn" onclick=nextStep()>Ø§Ù„ØªØ§Ù„ÙŠ</button>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 4: Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
            <div class="step" id="step4<div class=step-header">
                    <h2>Ø¥Ø¹Ø¯Ø§Ø¯ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</h2>
                    <p>ØªÙƒÙˆÙŠÙ† Ø§ØªØµØ§Ù„ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</p>
                </div>
                <div class="form-group<label for=db-type">Ù†ÙˆØ¹ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</label>
                    <select id="db-type<option value=postgresql">PostgreSQL (Ù…ÙˆØµÙ‰ Ø¨Ù‡)</option>
                        <option value="mysql">MySQL</option>
                        <option value="sqlite">SQLite (Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø±)</option>
                    </select>
                </div>
                <div class="form-group<label for=db-host">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø®Ø§Ø¯Ù…:</label>
                    <input type="text" id="db-host" value="localhost placeholder=localhostDIV_<div class=form-group<label for=db-port">Ø§Ù„Ù…Ù†ÙØ°:</label>
                    <input type="number" id="db-port" value="5432 placeholder=5432DIV_<div class=form-group<label for=db-name">Ø§Ø³Ù… Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:</label>
                    <input type="text" id="db-name" value="agri_ai_db placeholder=agri_ai_db">
                </div>
                <button class=btn btn-secondary onclick=prevStep()>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                <button class="btn" onclick=nextStep()>Ø§Ù„ØªØ§Ù„ÙŠ</button>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 5: ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… -->
            <div class="step" id="step5<div class=step-header">
                    <h2>ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</h2>
                    <p>Ø¬Ø§Ø±ÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙˆØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª</p>
                </div>
                <div id="initialization-status">
                    <div class=module-item>
                        <span>Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>
                        <span class="status-indicator status-pending" id="db-status"></span>
                    </div>
                    <div class=module-item>
                        <span>ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª</span>
                        <span class="status-indicator status-pending" id="modules-status"></span>
                    </div>
                    <div class=module-item>
                        <span>Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø¯Ù…Ø§Øª</span>
                        <span class="status-indicator status-pending" id="services-status"></span>
                    </div>
                </div>
                <button class=btn btn-secondary onclick=prevStep()>Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                <button class="btn" onclick="initializeSystem()" id="init-btn">Ø¨Ø¯Ø¡ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©</button>
            </div>

            <!-- Ø§Ù„Ø®Ø·ÙˆØ© 6: Ø§ÙƒØªÙ…Ø§Ù„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯ -->
            <div class="step" id="step6<div class=step-header">
                    <h2>ğŸ‰ ØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­!</h2>
                    <p>Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</p>
                </div>
                <div style="text-align: center;">
                    <button class="btn" onclick="window.location.href='/'">Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ù†Ø¸Ø§Ù…</button>
                    <button class=btn btn-secondary onclick="window.location.href='/admin'">Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</button>
                </div>
            </div>
        </div>

        <script>
            let currentStep = 1;
            const totalSteps = 6;

            function updateProgress() {{
                const progress = (currentStep / totalSteps) * 100;
                document.getElementById('progress').style.width = progress + '%';
            }}

            function showStep(step) {{
                // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø·ÙˆØ§Øª
                document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                document.getElementById('step' + step).classList.add('active');
                updateProgress();
            }}

            function nextStep() {{
                if (currentStep < totalSteps) {{
                    currentStep++;
                    showStep(currentStep);
                }}
            }}

            function prevStep() {{
                if (currentStep > 1) {{
                    currentStep--;
                    showStep(currentStep);
                }}
            }}

            async function initializeSystem() {{
                const initBtn = document.getElementById('init-btn');
                initBtn.disabled = true;
                initBtn.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©...';

                // Ù…Ø­Ø§ÙƒØ§Ø© Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
                await simulateInitialization();

                // Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø©
                nextStep();
            }}

            async function simulateInitialization() {{
                // ØªÙ‡ÙŠØ¦Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                await sleep(2000);
                document.getElementById('db-statusCLASSNAMEstatus-indicator status-success';

                // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª
                await sleep(3000);
                document.getElementById('modules-statusCLASSNAMEstatus-indicator status-success';

                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
                await sleep(2000);
                document.getElementById('services-statusCLASSNAMEstatus-indicator status-success';
            }}

            function sleep(ms) {{
                return new Promise(resolve => setTimeout(resolve, ms));
            }}

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¯Ù† Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¯ÙˆÙ„Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©
            async function updateCities() {{
                const countrySelect = document.getElementById('country');
                const citySelect = document.getElementById('city');
                const selectedCountry = countrySelect.value;

                // Ù…Ø³Ø­ Ø§Ù„Ù…Ø¯Ù† Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                citySelect.innerHTML = '<option value=">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¯Ù†...</option>';"
                citySelect.disabled = true;

                if (selectedCountry) {{
                    try {{
                        // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¯Ù† Ù…Ù† API
                        const response = await fetch(`/api/cities/${{selectedCountry}}`);
                        const data = await response.json();

                        if (data.cities && data.cities.length > 0) {{
                            // Ù…Ø³Ø­ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ù…Ø¤Ù‚ØªØ©
                            citySelect.innerHTML = '<option value=">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©</option>';"

                            // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¯Ù† Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
                            data.cities.forEach(city => {{
                                const option = document.createElement('option');
                                option.value = city;
                                option.textContent = city;
                                citySelect.appendChild(option);
                            }});

                            // ØªÙØ¹ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ù†
                            citySelect.disabled = false;
                        }} else {{
                            citySelect.innerHTML = '<option value=">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¯Ù† Ù…ØªØ§Ø­Ø©</option>';"
                        }}
                    }} catch (error) {{
                        console.error('Ø®Ø·Ø£ ÙÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¯Ù†:', error);
                        citySelect.innerHTML = '<option value=">Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø¯Ù†</option>';"
                    }}
                }} else {{
                    citySelect.innerHTML = '<option value=">Ø§Ø®ØªØ± Ø§Ù„Ø¯ÙˆÙ„Ø© Ø£ÙˆÙ„Ø§Ù‹</option>';"
                }}
            }}

            // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª ÙÙŠ localStorage
            function saveSettings() {{
                const settings = {{
                    orgName: document.getElementById('org-name').value,
                    orgType: document.getElementById('org-type').value,
                    country: document.getElementById('country').value,
                    city: document.getElementById('city').value,
                    modules: {{
                        ai_management: document.getElementById('ai_management').checked,
                        image_processing: document.getElementById('image_processing').checked,
                        disease_diagnosis: document.getElementById('disease_diagnosis').checked,
                        plant_hybridization: document.getElementById('plant_hybridization').checked
                    }},
                    database: {{
                        type: document.getElementById('db-type').value,
                        host: document.getElementById('db-host').value,
                        port: document.getElementById('db-port').value,
                        name: document.getElementById('db-name').value
                    }}
                }};

                localStorage.setItem('systemSettings', JSON.stringify(settings));
            }}

            // Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¹Ù†Ø¯ ÙƒÙ„ Ø®Ø·ÙˆØ©
            document.addEventListener('change', saveSettings);
        </script>
    </body>
    </html>
    ""
    return html.format(SYSTEM_NAME=SYSTEM_NAME)


# Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¬Ø°Ø± - ÙˆØ§Ø¬Ù‡Ø© Ø£Ù…Ø§Ù…ÙŠØ©
@app.get("/", response_class=HTMLResponse)
async def root():
    ""
    Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¬Ø°Ø± Ù„Ù„ØªØ·Ø¨ÙŠÙ‚ - ØªØ­ÙˆÙŠÙ„ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    ""
    # Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    return RedirectResponse(url=/login", status_code=302)"


# Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
@app.get("/admin", response_class=HTMLResponse)
async def admin_panel():
    ""
    Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
    ØªØ¹Ø±Ø¶ ÙˆØ§Ø¬Ù‡Ø© Ø¥Ø¯Ø§Ø±Ø© React Ù„Ù„Ù†Ø¸Ø§Ù…
    ""
    admin_html = ", <!DOCTYPE html>"
<htmlar" dir="rtl<head>
    <meta charset=UTF-8<meta name=viewport" content=width=device-width, initial-scale=10>"
        <title>Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ù†Ø¸Ø§Ù… Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©</title>
        <style>
            * {{
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }}
            body {{
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
                min-height: 100vh;
                color: white;
            }}
            .header {{
                background: rgba(0,0,0,0.2);
                padding: 1rem 2rem;
                display: flex;
                justify-content: space-between;
                align-items: center;
                backdrop-filter: blur(10px);
            }}
            .logo {{
                font-size: 1.5rem;
                font-weight: bold;
            }}
            .nav-links {{
                display: flex;
                gap: 1rem;
            }}
            .nav-link {{
                color: white;
                text-decoration: none;
                padding: 0.5rem 1rem;
                border-radius: 5px;
                transition: background 0.3s;
            }}
            .nav-link:hover {{
                background: rgba(255,255,255,0.2);
            }}
            .container {{
                max-width: 1200px;
                margin: 2rem auto;
                padding: 0 2rem;
            }}
            .dashboard-grid {{
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 2rem;
                margin-top: 2rem;
            }}
            .card {{
                background: rgba(255,255,255,0.1);
                padding: 2rem;
                border-radius: 15px;
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255,255,255,0.2);
                transition: transform 0.3s;
            }}
            .card:hover {{
                transform: translateY(-5px);
            }}
            .card h3 {{
                margin-bottom: 1rem;
                color: #fff;
            }}
            .card p {{
                opacity: 0.9;
                line-height: 1.6;
                margin-bottom: 1rem;
            }}
            .btn {{
                background: rgba(255,255,255,0.2);
                color: white;
                border: none;
                padding: 0.8rem 1.5rem;
                border-radius: 25px;
                cursor: pointer;
                transition: all 0.3s;
                text-decoration: none;
                display: inline-block;
            }}
            .btn:hover {{
                background: rgba(255,255,255,0.3);
                transform: translateY(-2px);
            }}
            .status-indicator {{
                display: inline-block;
                width: 10px;
                height: 10px;
                border-radius: 50%;
                margin-left: 0.5rem;
            }}
            .status-online {{ background: #4caf50; }}
            .status-offline {{ background: #f44336; }}
            .status-warning {{ background: #ff9800; }}
        </style>
    </head>
    <body>
        <div class="header">
            <div class="logo">ğŸŒ± {SYSTEM_NAME} - Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</div>
            <div class="nav-links">
                <a href="/" class="nav-linkØ§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©A_A_HREF/docs" class="nav-link">ğŸ“š Ø§Ù„ØªÙˆØ«ÙŠÙ‚</a>
                <a href="/health" class="nav-link">ğŸ¥ Ø§Ù„ØµØ­Ø©</a>
            </div>
        </div>

        <div class="container">
            <h1>ğŸ‰ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ø¸Ø§Ù…</h1>
            <p>Ø¥Ø¯Ø§Ø±Ø© Ø´Ø§Ù…Ù„Ø© Ù„{SYSTEM_NAME} Ø§Ù„Ù…Ø¹ØªÙ…Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</p>

            <div style="background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 10px; margin: 1rem 0;">
                <p>ğŸ‘¤ <strong>Ù…Ø±Ø­Ø¨Ø§Ù‹ Admin!</strong> | ğŸ•’ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­</p>
                <button onclick="logout()" style="background: #f44336; color: white; border: none; padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer; float: left;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
                <div style="clear: both;"></div>
            </div>

            <div class="dashboard-grid<div class=card">
                    <h3>ğŸ¤– Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h3>
                    <p>Ø¥Ø¯Ø§Ø±Ø© Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙˆØ®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ´Ø®ÙŠØµ</p>
                    <div>Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø©: <span class="status-indicator status-warning"></span> ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
                    <br>
                    <a href="/ai-management" class="btn">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ù…Ø§Ø°Ø¬</a>
                </div>

                <div class="card">
                    <h3>ğŸŒ¾ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</h3>
                    <p>Ù…ØªØ§Ø¨Ø¹Ø© ÙˆÙ…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ ÙˆØ§Ù„Ù…Ø­Ø§ØµÙŠÙ„</p>
                    <div>Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø©: <span class="status-indicator status-onlineSPAN_Ù…ØªØµÙ„DIV_BR/farms" class="btn">Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</a>
                </div>

                <div class="card">
                    <h3>ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ÙˆØ§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h3>
                    <p>ØªÙ‚Ø§Ø±ÙŠØ± Ù…ÙØµÙ„Ø© ÙˆØ¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø©</p>
                    <div>Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø©: <span class="status-indicator status-online"></span> Ù…ØªØµÙ„</div>
                    <br>
                    <button class="btn" onclick="alert('Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹')">Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</button>
                </div>

                <div class="card">
                    <h3>ğŸ”¬ ØªÙ‡Ø¬ÙŠÙ† Ø§Ù„Ù†Ø¨Ø§ØªØ§Øª</h3>
                    <p>Ù…Ø­Ø§ÙƒØ§Ø© ÙˆØªØ­Ù„ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªÙ‡Ø¬ÙŠÙ†</p>
                    <div>Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø©: <span class="status-indicator status-warning"></span> ÙÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
                    <br>
                    <button class="btn" onclick="alert('Ø³ÙŠØªÙ… ØªÙØ¹ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹')">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„ØªÙ‡Ø¬ÙŠÙ†</button>
                </div>

                <div class="card">
                    <h3>âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</h3>
                    <p>ØªÙƒÙˆÙŠÙ† Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</p>
                    <div>Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø©: <span class="status-indicator status-onlineSPAN_Ù…ØªØµÙ„DIV_BR/api/info" class="btn">Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</a>
                </div>

                <div class="card">
                    <h3>ğŸ“ˆ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©</h3>
                    <p>Ù…Ø±Ø§Ù‚Ø¨Ø© Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ§Ù„Ø®ÙˆØ§Ø¯Ù…</p>
                    <div>Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø©: <span class="status-indicator status-onlineSPAN_Ù…ØªØµÙ„DIV_BRhttp://localhost:9090" target=", _blank" class="btn">Prometheus</a>
                </div>
            </div>
        </div>

        <script>
            // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
            setInterval(async () => {
                try {
                    const response = await fetch('/health');
                    const data = await response.json();
                    console.log('System health:', data);
                } catch (error) {
                    console.error('Health check failed:', error);
                }
            }, 30000);

            // Ø¥Ø¶Ø§ÙØ© ØªÙØ§Ø¹Ù„ÙŠØ© Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª
            document.querySelectorAll('.card').forEach(card => {
                card.addEventListener('click', () => {
                    card.style.transform = 'scale(1.02)';
                    setTimeout(() => {
                        card.style.transform = '';
                    }, 200);
                });
            });

            // Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
            function logout() {
                if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ù†Ø¸Ø§Ù…ØŸ')) {
                    localStorage.removeItem('user');
                    window.location.href = '/login';
                }
            }
        </script>
    </body>
    </html>
    ""
    return admin_html.replace('{SYSTEM_NAME}', SYSTEM_NAME)


# Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ - Ù…ØªØµÙ„Ø© Ø¨Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„ Ø§Ù„ÙØ¹Ù„ÙŠ
@app.get("/ai-management", response_class=HTMLResponse)
async def ai_management():
    "ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…ØªØµÙ„Ø© Ø¨Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„ Ø§Ù„ÙØ¹Ù„ÙŠ"", HTML, "<!DOCTYPE html>
<htmlar" dir="rtl<head>
    <meta charset=UTF-8<meta name=viewport" content=width=device-width, initial-scale=10>"
        <title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ - Ù†Ø¸Ø§Ù… Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©</title>
        <style>
            * {{ margin: 0; padding: 0; box-sizing: border-box; }}
            body {{
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
                min-height: 100vh; color: white;
            }}
            .header {{
                background: rgba(0,0,0,0.2); padding: 1rem 2rem;
                display: flex; justify-content: space-between; align-items: center;
                backdrop-filter: blur(10px);
            }}
            .nav-link {{
                color: white; text-decoration: none; padding: 0.5rem 1rem;
                border-radius: 5px; transition: background 0.3s; margin: 0 0.5rem;
            }}
            .nav-link:hover {{ background: rgba(255,255,255,0.2); }}
            .container {{ max-width: 1200px; margin: 2rem auto; padding: 0 2rem; }}
            .card {{
                background: rgba(255,255,255,0.1); padding: 2rem; border-radius: 15px;
                backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);
                margin: 1rem 0;
            }}
            .grid {{ display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; }}
            .btn {{
                background: #4CAF50; color: white; border: none;
                padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;
                margin: 0.5rem; transition: background 0.3s;
            }}
            .btn:hover {{ background: #45a049; }}
            .status {{ padding: 0.3rem 0.8rem; border-radius: 15px; font-size: 0.9rem; }}
            .status-online {{ background: #4CAF50; }}
            .status-offline {{ background: #f44336; }}
            .loading {{ text-align: center; padding: 2rem; }}
        </style>
    </head>
    <body>
        <div class="header">
            <div>ğŸ¤– Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</div>
            <div>
                <a href="/" class="nav-linkØ§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©A_A_HREF/admin" class="nav-link">ğŸ›ï¸ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
                <a href="/docs" class="nav-link">ğŸ“š Ø§Ù„ØªÙˆØ«ÙŠÙ‚</a>
            </div>
        </div>
        <div class="container">
            <h1>ğŸ¤– Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h1>

            <div class="card">
                <h3>ğŸ“Š Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª</h3>
                <div id="modules-status" class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª...</div>
            </div>

            <div class="card">
                <h3>ğŸ”§ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª</h3>
                <div class="grid">
                    <div>
                        <h4>Ù…Ø¯ÙŠÙˆÙ„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h4>
                        <button class="btn" onclick="startModule('ai_management')ØªØ´ØºÙŠÙ„_Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„BUTTON_BUTTONbtn" onclick="stopModule('ai_management')Ø¥ÙŠÙ‚Ø§Ù_Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„BUTTON_BUTTONbtn" onclick="getModuleStatus('ai_management')">ÙØ­Øµ Ø§Ù„Ø­Ø§Ù„Ø©</button>
                    </div>
                    <div>
                        <h4>Ù…Ø¯ÙŠÙˆÙ„ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±</h4>
                        <button class="btn" onclick="startModule('image_processing')ØªØ´ØºÙŠÙ„_Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„BUTTON_BUTTONbtn" onclick="stopModule('image_processing')Ø¥ÙŠÙ‚Ø§Ù_Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„BUTTON_BUTTONbtn" onclick="getModuleStatus('image_processing')">ÙØ­Øµ Ø§Ù„Ø­Ø§Ù„Ø©</button>
                    </div>
                    <div>
                        <h4>Ù…Ø¯ÙŠÙˆÙ„ ØªØ´Ø®ÙŠØµ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶</h4>
                        <button class="btn" onclick="startModule('disease_diagnosis')ØªØ´ØºÙŠÙ„_Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„BUTTON_BUTTONbtn" onclick="stopModule('disease_diagnosis')Ø¥ÙŠÙ‚Ø§Ù_Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„BUTTON_BUTTONbtn" onclick="getModuleStatus('disease_diagnosis')">ÙØ­Øµ Ø§Ù„Ø­Ø§Ù„Ø©</button>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>ğŸ“ˆ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</h3>
                <div id="ai-stats" class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª...</div>
            </div>
        </div>

        <script>
            // ØªØ­Ù…ÙŠÙ„ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª
            async function loadModulesStatus() {
                try {
                    const response = await fetch('/api/modules/status');
                    const data = await response.json();

                    let html = '<div class="grid">';
                    data.modules.forEach(module => {
                        const statusClass = module.status === 'running' ? 'status-online' : 'status-offline';
                        html += `
                            <div>
                                <h4>${module.nameAr}</h4>
                                <p>${module.descriptionAr}</p>
                                <span class="status ${statusClass}">${module.status}</span>
                            </div>
                        `;
                    });
                    html += '</div>';

                    document.getElementById('modules-statusINNERHTML_HTML_CATCHmodules-statusINNERHTMLØ®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª';
                }
            }

            // ØªØ´ØºÙŠÙ„ Ù…Ø¯ÙŠÙˆÙ„
            async function startModule(moduleId) {
                try {
                    const response = await fetch(`/api/modules/${moduleId}/start`, { method: 'POST' });
                    const data = await response.json();
                    alert(data.message || 'ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„');
                    loadModulesStatus();
                } catch (error) {
                    alert('Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„');
                }
            }

            // Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¯ÙŠÙˆÙ„
            async function stopModule(moduleId) {
                try {
                    const response = await fetch(`/api/modules/${moduleId}/stop`, { method: 'POST' });
                    const data = await response.json();
                    alert(data.message || 'ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„');
                    loadModulesStatus();
                } catch (error) {
                    alert('Ø®Ø·Ø£ ÙÙŠ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„');
                }
            }

            // ÙØ­Øµ Ø­Ø§Ù„Ø© Ù…Ø¯ÙŠÙˆÙ„
            async function getModuleStatus(moduleId) {
                try {
                    const response = await fetch(`/api/modules/${moduleId}/status`);
                    const data = await response.json();
                    alert(`Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„: ${data.status}`);
                } catch (error) {
                    alert('Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„');
                }
            }

            // ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
            async function loadAIStats() {
                try {
                    const response = await fetch('/api/ai/stats');
                    const data = await response.json();

                    let html = `
                        <div class="grid">
                            <div><strong>Ø¹Ø¯Ø¯ Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡ Ø§Ù„Ù†Ø´Ø·ÙŠÙ†:</strong> ${data.active_agents || 0}</div>
                            <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª:</strong> ${data.total_requests || 0}</div>
                            <div><strong>Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…:</strong> ${data.today_requests || 0}</div>
                            <div><strong>Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­:</strong> ${data.success_rate || 0}%</div>
                        </div>
                    `;

                    document.getElementById('ai-statsINNERHTML_HTML_CATCHai-statsINNERHTMLØ®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª';
                }
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            document.addEventListener('DOMContentLoaded', function() {
                loadModulesStatus();
                loadAIStats();

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ 30 Ø«Ø§Ù†ÙŠØ©
                setInterval(() => {
                    loadModulesStatus();
                    loadAIStats();
                }, 30000);
            });
        </script>
    </body>
    </html>
    ""
    return html


@app.get("/analytics", response_class=HTMLResponse)
async def analytics_page():
    "ØµÙØ­Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª"", HTML, "<!DOCTYPE html>
<htmlar" dir="rtl<head>
    <meta charset=UTF-8<meta name=viewport" content=width=device-width, initial-scale=10>"
        <title>Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª - Ù†Ø¸Ø§Ù… Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©</title>
        <style>
            * {{ margin: 0; padding: 0; box-sizing: border-box; }}
            body {{
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh; padding: 20px; direction: rtl;
            }}
            .container {{ max-width: 1400px; margin: 0 auto; }}
            .header {{
                background: rgba(255, 255, 255, 0.95); padding: 20px;
                border-radius: 15px; margin-bottom: 30px;
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); text-align: center;
            }}
            .header h1 {{ color: #2c3e50; margin-bottom: 10px; font-size: 2.5em; }}
            .nav-buttons {{ margin: 20px 0; text-align: center; }}
            .nav-buttons a {{
                display: inline-block; margin: 0 10px; padding: 12px 24px;
                background: linear-gradient(45deg, #3498db, #2980b9);
                color: white; text-decoration: none; border-radius: 25px;
                transition: all 0.3s ease; font-weight: bold;
            }}
            .nav-buttons a:hover {{ transform: translateY(-2px); }}
            .dashboard-grid {{
                display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 20px; margin-bottom: 30px;
            }}
            .card {{
                background: rgba(255, 255, 255, 0.95); padding: 25px;
                border-radius: 15px; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
                transition: transform 0.3s ease;
            }}
            .card:hover {{ transform: translateY(-5px); }}
            .card h3 {{
                color: #2c3e50; margin-bottom: 20px; font-size: 1.5em;
                border-bottom: 2px solid #3498db; padding-bottom: 10px;
            }}
            .stats-grid {{
                display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 15px; margin: 20px 0;
            }}
            .stat-item {{
                background: linear-gradient(45deg, #f8f9fa, #e9ecef);
                padding: 15px; border-radius: 10px; text-align: center;
                border: 2px solid transparent; transition: all 0.3s ease;
            }}
            .stat-item:hover {{ border-color: #3498db; transform: scale(1.05); }}
            .stat-value {{
                font-size: 2em; font-weight: bold; color: #2c3e50; display: block;
            }}
            .stat-label {{ color: #7f8c8d; font-size: 0.9em; margin-top: 5px; }}
            .btn {{
                background: linear-gradient(45deg, #27ae60, #2ecc71);
                color: white; border: none; padding: 12px 24px;
                border-radius: 25px; cursor: pointer; font-size: 1em;
                font-weight: bold; transition: all 0.3s ease; margin: 5px;
            }}
            .btn:hover {{ transform: translateY(-2px); }}
            .loading {{ text-align: center; color: #7f8c8d; font-style: italic; }}
            .alert {{
                padding: 15px; margin: 10px 0; border-radius: 10px; border-left: 4px solid;
            }}
            .alert-success {{ background: #d4edda; border-color: #27ae60; color: #155724; }}
            .alert-warning {{ background: #fff3cd; border-color: #f39c12; color: #856404; }}
            .alert-danger {{ background: #f8d7da; border-color: #e74c3c; color: #721c24; }}
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>ğŸ“Š Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª ÙˆØ§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</h1>
                <p>Ù…Ø±Ø§Ù‚Ø¨Ø© ÙˆØªØ­Ù„ÙŠÙ„ Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù… ÙˆØ§Ù„Ù…Ø²Ø§Ø±Ø¹</p>
                <div class="nav-buttons">
                    <a href="/">ğŸ  Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
                    <a href="/admin">âš™ï¸ Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
                    <a href="/farms">ğŸŒ¾ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</a>
                    <a href="/ai-management">ğŸ¤– Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</a>
                </div>
            </div>

            <div class="dashboard-grid<div class=card">
                    <h3>ğŸ“ˆ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø§Ù…Ø©</h3>
                    <div id="system-stats" class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª...</div>
                    <button class="btn" onclick="loadSystemStats()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</button>
                </div>

                <div class="card">
                    <h3>ğŸŒ¾ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</h3>
                    <div id="farms-stats" class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø²Ø§Ø±Ø¹...</div>
                    <button class="btn" onclick="loadFarmsStats()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                </div>

                <div class="card">
                    <h3>ğŸ¤– Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</h3>
                    <div id="ai-stats" class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ...</div>
                    <button class="btn" onclick="loadAIStats()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
                </div>

                <div class="card">
                    <h3>âš™ï¸ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª</h3>
                    <div id="services-status" class="loading">Ø¬Ø§Ø±ÙŠ ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª...</div>
                    <button class="btn" onclick="loadServicesStatus()">ÙØ­Øµ Ø§Ù„Ø­Ø§Ù„Ø©</button>
                </div>
            </div>
        </div>

        <script>
            async function loadSystemStats() {
                try {
                    const response = await fetch('/api/dashboard/stats');
                    const data = await response.json();
                    let html = `
                        <div class="stats-grid">
                            <div class="stat-itemSPAN_CLASSstat-value">${data.system?.uptime || '0 Ø£ÙŠØ§Ù…'}</span>
                                <div class="stat-label">Ù…Ø¯Ø© Ø§Ù„ØªØ´ØºÙŠÙ„</div>
                            </div>
                            <div class="stat-itemSPAN_CLASSstat-value">${data.system?.cpu_usage || '0%'}</span>
                                <div class="stat-label">Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬</div>
                            </div>
                            <div class="stat-itemSPAN_CLASSstat-value">${data.system?.memory_usage || '0%'}</span>
                                <div class="stat-label">Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°Ø§ÙƒØ±Ø©</div>
                            </div>
                            <div class="stat-itemSPAN_CLASSstat-value">${data.system?.disk_usage || '0%'}</span>
                                <div class="stat-label">Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù‚Ø±Øµ</div>
                            </div>
                        </div>
                        <div class="alert alert-success">âœ… Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ</div>
                    `;
                    document.getElementById('system-statsINNERHTML_HTML_CATCHsystem-statsINNERHTML<div class=ALERT_ALERTDANGER>âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù†Ø¸Ø§Ù…</div>';
                }
            }

            async function loadFarmsStats() {
                try {
                    const response = await fetch('/api/farms/stats');
                    const data = await response.json();
                    let html = `
                        <div class="stats-grid">
                            <div class="stat-itemSPAN_CLASSstat-value">${data.total_farms || 0}</span>
                                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</div>
                            </div>
                            <div class="stat-itemSPAN_CLASSstat-value">${data.active_farms || 0}</span>
                                <div class="stat-label">Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù†Ø´Ø·Ø©</div>
                            </div>
                            <div class="stat-itemSPAN_CLASSstat-value">${data.total_crops || 0}</span>
                                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„</div>
                            </div>
                            <div class="stat-itemSPAN_CLASSstat-value">${data.healthy_crops || 0}</span>
                                <div class="stat-label">Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„ Ø§Ù„ØµØ­ÙŠØ©</div>
                            </div>
                        </div>
                    `;
                    document.getElementById('farms-statsINNERHTML_HTML_CATCHfarms-statsINNERHTML<div class=ALERT_ALERTDANGER>âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</div>';
                }
            }

            async function loadAIStats() {
                try {
                    const response = await fetch('/api/ai/stats');
                    const data = await response.json();
                    let html = `
                        <div class="stats-grid">
                            <div class="stat-itemSPAN_CLASSstat-value">${data.active_agents || 0}</span>
                                <div class="stat-label">Ø§Ù„ÙˆÙƒÙ„Ø§Ø¡ Ø§Ù„Ù†Ø´Ø·ÙˆÙ†</div>
                            </div>
                            <div class="stat-itemSPAN_CLASSstat-value">${data.total_requests || 0}</span>
                                <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨Ø§Øª</div>
                            </div>
                            <div class="stat-itemSPAN_CLASSstat-value">${data.today_requests || 0}</span>
                                <div class="stat-label">Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…</div>
                            </div>
                            <div class="stat-itemSPAN_CLASSstat-value">${data.success_rate || 0}%</span>
                                <div class="stat-label">Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­</div>
                            </div>
                        </div>
                    `;
                    document.getElementById('ai-statsINNERHTML_HTML_CATCHai-statsINNERHTML<div class=ALERT_ALERTDANGER>âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</div>';
                }
            }

            async function loadServicesStatus() {
                try {
                    const response = await fetch('/api/services/status');
                    const data = await response.json();
                    let html = '<div class="stats-grid">';
                    for (const [service, info] of Object.entries(data.services || {})) {
                        const statusIcon = info.status === 'online' ? 'ğŸŸ¢' :
                                         info.status === 'pending' ? 'ğŸŸ¡' : 'ğŸ”´';
                        html += `
                            <div class="stat-itemSPAN_CLASSstat-value">${statusIcon}</span>
                                <div class="stat-label">${info.name}</div>
                            </div>
                        `;
                    }
                    html += '</div>';
                    document.getElementById('services-statusINNERHTML_HTML_CATCHservices-statusINNERHTML<div class=ALERT_ALERTDANGER>âŒ Ø®Ø·Ø£ ÙÙŠ ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª</div>';
                }
            }

            document.addEventListener('DOMContentLoaded', function() {
                loadSystemStats();
                loadFarmsStats();
                loadAIStats();
                loadServicesStatus();
                setInterval(() => {
                    loadSystemStats();
                    loadFarmsStats();
                    loadAIStats();
                    loadServicesStatus();
                }, 120000);
            });
        </script>
    </body>
    </html>
    ""
    return html


# Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ù„Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ - Ù…ØªØµÙ„Ø© Ø¨Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©
@app.get("/farms", response_class=HTMLResponse)
async def farms_management():
    "ØµÙØ­Ø© Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ Ù…ØªØµÙ„Ø© Ø¨Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ©"", HTML, "<!DOCTYPE html>
<htmlar" dir="rtl<head>
    <meta charset=UTF-8<meta name=viewport" content=width=device-width, initial-scale=10>"
        <title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ - Ù†Ø¸Ø§Ù… Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©</title>
        <style>
            * {{ margin: 0; padding: 0; box-sizing: border-box; }}
            body {{
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
                min-height: 100vh; color: white;
            }}
            .header {{
                background: rgba(0,0,0,0.2); padding: 1rem 2rem;
                display: flex; justify-content: space-between; align-items: center;
                backdrop-filter: blur(10px);
            }}
            .nav-link {{
                color: white; text-decoration: none; padding: 0.5rem 1rem;
                border-radius: 5px; transition: background 0.3s; margin: 0 0.5rem;
            }}
            .nav-link:hover {{ background: rgba(255,255,255,0.2); }}
            .container {{ max-width: 1200px; margin: 2rem auto; padding: 0 2rem; }}
            .card {{
                background: rgba(255,255,255,0.1); padding: 2rem; border-radius: 15px;
                backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.2);
                margin: 1rem 0;
            }}
            .grid {{ display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; }}
            .btn {{
                background: #4CAF50; color: white; border: none;
                padding: 0.5rem 1rem; border-radius: 5px; cursor: pointer;
                margin: 0.5rem; transition: background 0.3s;
            }}
            .btn:hover {{ background: #45a049; }}
            .btn-secondary {{ background: #ff9800; }}
            .btn-secondary:hover {{ background: #f57c00; }}
            .loading {{ text-align: center; padding: 2rem; }}
            .farm-item {{
                background: rgba(255,255,255,0.1); padding: 1rem; border-radius: 10px;
                margin: 0.5rem 0; border: 1px solid rgba(255,255,255,0.2);
            }}
        </style>
    </head>
    <body>
        <div class="header">
            <div>ğŸŒ¾ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</div>
            <div>
                <a href="/" class="nav-linkØ§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©A_A_HREF/admin" class="nav-link">ğŸ›ï¸ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</a>
                <a href="/docs" class="nav-link">ğŸ“š Ø§Ù„ØªÙˆØ«ÙŠÙ‚</a>
            </div>
        </div>
        <div class="container">
            <h1>ğŸŒ¾ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</h1>

            <div class="card">
                <h3>ğŸ“ˆ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</h3>
                <div id="farm-stats" class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª...</div>
                <button class="btn" onclick="addNewFarm()">Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±Ø¹Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
                <button class=btn btn-secondary onclick="loadFarms()">ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            </div>

            <div class="card">
                <h3>ğŸ¡ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹</h3>
                <div id="farms-list" class="loading">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹...</div>
            </div>

            <div class="card">
                <h3>ğŸŒ± Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„</h3>
                <div class="grid">
                    <div>
                        <h4>ØªØ´Ø®ÙŠØµ Ø§Ù„Ø£Ù…Ø±Ø§Ø¶</h4>
                        <p>Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù„ØªØ´Ø®ÙŠØµ Ø£Ù…Ø±Ø§Ø¶ Ø§Ù„Ù†Ø¨Ø§ØªØ§Øª</p>
                        <button class="btn" onclick="openDiagnosisModule()">ÙØªØ­ Ù…Ø¯ÙŠÙˆÙ„ Ø§Ù„ØªØ´Ø®ÙŠØµ</button>
                    </div>
                    <div>
                        <h4>Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±</h4>
                        <p>ØªØ­Ù„ÙŠÙ„ ØµÙˆØ± Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„ ÙˆØ§Ù„Ù†Ø¨Ø§ØªØ§Øª</p>
                        <button class="btn" onclick="openImageProcessing()">ÙØªØ­ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±</button>
                    </div>
                    <div>
                        <h4>ØªÙ‡Ø¬ÙŠÙ† Ø§Ù„Ù†Ø¨Ø§ØªØ§Øª</h4>
                        <p>Ù…Ø­Ø§ÙƒØ§Ø© ÙˆØªØ­Ù„ÙŠÙ„ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªÙ‡Ø¬ÙŠÙ†</p>
                        <button class="btn" onclick="openHybridization()">ÙØªØ­ Ù…Ø¯ÙŠÙˆÙ„ Ø§Ù„ØªÙ‡Ø¬ÙŠÙ†</button>
                    </div>
                </div>
            </div>
        </div>

        <script>
            // ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø²Ø§Ø±Ø¹
            async function loadFarmStats() {
                try {
                    const response = await fetch('/api/farms/stats');
                    const data = await response.json();

                    let html = `
                        <div class="grid">
                            <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹:</strong> ${data.total_farms || 0}</div>
                            <div><strong>Ø§Ù„Ù…Ø²Ø§Ø±Ø¹ Ø§Ù„Ù†Ø´Ø·Ø©:</strong> ${data.active_farms || 0}</div>
                            <div><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„:</strong> ${data.total_crops || 0}</div>
                            <div><strong>Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„ Ø§Ù„ØµØ­ÙŠØ©:</strong> ${data.healthy_crops || 0}</div>
                            <div><strong>Ø§Ù„Ù…Ø­Ø§ØµÙŠÙ„ Ø§Ù„Ù…Ø±ÙŠØ¶Ø©:</strong> ${data.diseased_crops || 0}</div>
                            <div><strong>Ø¢Ø®Ø± ØªØ­Ø¯ÙŠØ«:</strong> ${data.last_update || 'ØºÙŠØ± Ù…ØªÙˆÙØ±'}</div>
                        </div>
                    `;

                    document.getElementById('farm-statsINNERHTML_HTML_CATCHfarm-statsINNERHTMLØ®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª';
                }
            }

            // ØªØ­Ù…ÙŠÙ„ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹
            async function loadFarms() {
                try {
                    const response = await fetch('/api/farms/list');
                    const data = await response.json();

                    let html = '';
                    if (data.farms && data.farms.length > 0) {
                        data.farms.forEach(farm => {
                            html += `
                                <div class="farm-item">
                                    <h4>${farm.name}</h4>
                                    <p><strong>Ø§Ù„Ù…ÙˆÙ‚Ø¹:</strong> ${farm.location}</p>
                                    <p><strong>Ø§Ù„Ù…Ø³Ø§Ø­Ø©:</strong> ${farm.area} Ù‡ÙƒØªØ§Ø±</p>
                                    <p><strong>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØµÙˆÙ„:</strong> ${farm.crop_type}</p>
                                    <p><strong>Ø§Ù„Ø­Ø§Ù„Ø©:</strong> ${farm.status}</p>
                                    <button class="btn" onclick="viewFarm('${farm.id}')">Ø¹Ø±Ø¶ Ø§Ù„ØªÙØ§ØµÙŠÙ„</button>
                                    <button class=btn btn-secondary onclick="editFarm('${farm.id}')">ØªØ¹Ø¯ÙŠÙ„</button>
                                </div>
                            `;
                        });
                    } else {
                        html = '<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø²Ø§Ø±Ø¹ Ù…Ø³Ø¬Ù„Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</p>';
                    }

                    document.getElementById('farms-listINNERHTML_HTML_CATCHfarms-listINNERHTMLØ®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²Ø§Ø±Ø¹';
                }
            }

            // Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±Ø¹Ø© Ø¬Ø¯ÙŠØ¯Ø©
            function addNewFarm() {
                const name = prompt('Ø§Ø³Ù… Ø§Ù„Ù…Ø²Ø±Ø¹Ø©:');
                const location = prompt('Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø²Ø±Ø¹Ø©:');
                const area = prompt('Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø²Ø±Ø¹Ø© (Ø¨Ø§Ù„Ù‡ÙƒØªØ§Ø±):');
                const cropType = prompt('Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­ØµÙˆÙ„:');

                if (name && location && area && cropType) {
                    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø®Ø§Ø¯Ù…
                    fetch('/api/farms/add', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ name, location, area, crop_type: cropType })
                    })
                    .then(response => response.json())
                    .then(data => {
                        alert(data.message || 'ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ø¨Ù†Ø¬Ø§Ø­');
                        loadFarms();
                        loadFarmStats();
                    })
                    .catch(error => {
                        alert('Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²Ø±Ø¹Ø©');
                    });
                }
            }

            // Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ù…Ø²Ø±Ø¹Ø©
            function viewFarm(farmId) {
                alert(`Ø¹Ø±Ø¶ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© ${farmId} - Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹`);
            }

            // ØªØ¹Ø¯ÙŠÙ„ Ù…Ø²Ø±Ø¹Ø©
            function editFarm(farmId) {
                alert(`ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø²Ø±Ø¹Ø© ${farmId} - Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„Ù…ÙŠØ²Ø© Ù‚Ø±ÙŠØ¨Ø§Ù‹`);
            }

            // ÙØªØ­ Ù…Ø¯ÙŠÙˆÙ„ Ø§Ù„ØªØ´Ø®ÙŠØµ
            function openDiagnosisModule() {
                window.open('/diagnosis', '_blank');
            }

            // ÙØªØ­ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØ±
            function openImageProcessing() {
                window.open('/image-processing', '_blank');
            }

            // ÙØªØ­ Ù…Ø¯ÙŠÙˆÙ„ Ø§Ù„ØªÙ‡Ø¬ÙŠÙ†
            function openHybridization() {
                window.open('/plant-hybridization', '_blank');
            }

            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            document.addEventListener('DOMContentLoaded', function() {
                loadFarmStats();
                loadFarms();

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
                setInterval(() => {
                    loadFarmStats();
                    loadFarms();
                }, 60000);
            });
        </script>
    </body>
    </html>
    ""
    return html


# Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© API Ù„Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
@app.get("/api/info")
async def api_info() -> Dict[str, str]:
    ""
    Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© API Ù„Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    ØªØ¹Ø±Ø¶ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø£Ø³Ø§Ø³ÙŠØ© Ø¹Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ ÙÙŠ ØµÙŠØºØ© JSON
    "", RETURNname": "Ù†Ø¸Ø§Ù… Ø§Ù„Ø²Ø±Ø§Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠØ©"version: "1.0.0"status: "running"documentation: "/docs","
    }
    }


# Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø®Ø¯Ù…Ø§Øª
@app.get("/api/services/status")
async def services_status():
    ""
    Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ù„ÙØ­Øµ Ø­Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª
    "", RETURNservices"database: {"status": "online", "name": ", PostgreSQL, "cache: {"status": "online", "name": ", Redis"queue: {"status": "online", "name": ", RabbitMQ, "search: {"status": "online", "name": ", Elasticsearch"storage: {"status": "online", "name": ", MinIO, "ai_service: {"status": "pending", "name": ", AI Management"image_processing: {"status": "pending", "name": ", Image Processing"disease_diagnosis: {"status": "pending", "name": ", Disease Diagnosis"plant_hybridization: {"status": "pending", "name": ", Plant Hybridization"monitoring: {"status": "online", "name": ", Prometheus"}"
        },
        "overall_status": "partial"timestamp: "2024-01-01T00:00:00Z, "
    }


# Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
@app.get("/api/dashboard/stats")
async def dashboard_stats():
    ""
    Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ù„Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
    "", RETURNfarms": {"total": 0, "active": {"total": 0, "healthy": 0, "diseased": {"today": 0, "this_week": 0, "this_month": {"active": 0, "resolved""uptime": "0 days"cpu_usage: "0%"memory_usage: "0%"disk_usage: "0%""
    }
        }
    }


# Ù†Ù‚Ø§Ø· Ù†Ù‡Ø§ÙŠØ© Ù„Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª Ø§Ù„ÙØ¹Ù„ÙŠØ© - ØªÙ… Ø¯Ù…Ø¬Ù‡Ø§ Ù…Ø¹ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø© Ø£Ø¹Ù„Ø§Ù‡


@app.post("/api/modules/{module_id}/start")
async def start_module(module_id: str):
    "ØªØ´ØºÙŠÙ„ Ù…Ø¯ÙŠÙˆÙ„ Ù…Ø¹ÙŠÙ†"""
    try:
        # Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ø¯ÙŠÙˆÙ„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª
        from src.modules.module_management.api import start_module as start_mod
        start_mod(module_id)
        return {message": f"ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„ {module_id}", "status": "success"}"
    except ImportError:
        return {"message": f"ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„ {module_id} (Ù…Ø­Ø§ÙƒØ§Ø©)", "status": "success"}


@app.post("/api/modules/{module_id}/stop")
async def stop_module(module_id: str):
    "Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¯ÙŠÙˆÙ„ Ù…Ø¹ÙŠÙ†"""
    try:
        # Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ø¯ÙŠÙˆÙ„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª
        from src.modules.module_management.api import stop_module as stop_mod
        stop_mod(module_id)
        return {message": f"ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„ {module_id}", "status": "success"}"
    except ImportError:
        return {"message": f"ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„ {module_id} (Ù…Ø­Ø§ÙƒØ§Ø©)", "status": "success"}


@app.get("/api/modules/{module_id}/status")
async def get_module_status(module_id: str):
    "Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ù…Ø¯ÙŠÙˆÙ„ Ù…Ø¹ÙŠÙ†"""
    try:
        # Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ø¯ÙŠÙˆÙ„ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø¯ÙŠÙˆÙ„Ø§Øª
        from src.modules.module_management.api import get_module_status as get_status
        status = get_status(module_id)
        return {module_id": module_id, "status": status}"
    except ImportError:
        return {"module_id": module_id, "status": "stopped"}


@app.get("/api/ai/stats")
async def get_ai_stats():
    "Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ"""
    try:
        # Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ø³ØªÙŠØ±Ø§Ø¯ Ù…Ø¯ÙŠÙˆÙ„ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
        from src.modules.ai_management.api import get_ai_stats as get_stats
        stats = get_stats()
        return stats
    except ImportError:
        return {
            active_agents"": module_not_loaded""
        }


# Ù†Ù‚Ø§Ø· Ù†Ù‡Ø§ÙŠØ© Ù„Ù„Ù…Ø²Ø§Ø±Ø¹
@app.get("/api/farms/stats")
async def get_farms_stats():
    "Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…Ø²Ø§Ø±Ø¹"", RETURNtotal_farms": "2024-01-01 00:00:00"
    }
    }


@app.get("/api/farms/list")
async def get_farms_list():
    "Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø²Ø§Ø±Ø¹"", RETURNfarms": [],
    }
        "total": "success"
    }


@app.post("/api/farms/add")
async def add_farm(farm_data: dict):
    "Ø¥Ø¶Ø§ÙØ© Ù…Ø²Ø±Ø¹Ø© Ø¬Ø¯ÙŠØ¯Ø©"""
    # Ø§Ø³ØªØ®Ø¯Ø§Ù… farm_data ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ù„Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    _ = farm_data  # ØªØ¬Ø§Ù‡Ù„ Ø§Ù„ØªØ­Ø°ÙŠØ± Ù…Ø¤Ù‚ØªØ§Ù‹
    return {
        message": "ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²Ø±Ø¹Ø© Ø¨Ù†Ø¬Ø§Ø­ (Ù…Ø­Ø§ÙƒØ§Ø©)"farm_id: "farm_001"status: "success""
    }


# Ù†Ù‚Ø·Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØµØ­Ø© - ØªÙ… Ø¯Ù…Ø¬Ù‡Ø§ Ù…Ø¹ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø­Ø³Ù†Ø© Ø£Ø¹Ù„Ø§Ù‡


# Ù†Ù‚Ø§Ø· Ù†Ù‡Ø§ÙŠØ© API Ù„Ù„Ø¯ÙˆÙ„ ÙˆØ§Ù„Ù…Ø¯Ù†
@app.get("/api/countries")
async def get_countries():
    "Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆÙ„"""
    try:
        # Ù…Ø­Ø§ÙƒØ§Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        countries = [
            {code": ", SA, ", "name_ar": "Ø¬Ù…Ù‡ÙˆØ±ÙŠØ© Ù…ØµØ± Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©", "region": ", Arab"code: ", AE, ", "name_ar": "Ø§Ù„Ø¥Ù…Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ù…ØªØ­Ø¯Ø©", "region": ", Arab"code: ", EG, ", "name_ar": "Ù…ØµØ±", "region": ", Arab"code: ", JO, ", "name_ar": "Ø§Ù„Ø£Ø±Ø¯Ù†", "region": ", Arab"code: ", LB, ", "name_ar": "Ù„Ø¨Ù†Ø§Ù†", "region": ", Arab"code: ", SY, ", "name_ar": "Ø³ÙˆØ±ÙŠØ§", "region": ", Arab"code: ", IQ, ", "name_ar": "Ø§Ù„Ø¹Ø±Ø§Ù‚", "region": ", Arab"code: ", KW, ", "name_ar": "Ø§Ù„ÙƒÙˆÙŠØª", "region": ", Arab"code: ", QA, ", "name_ar": "Ù‚Ø·Ø±", "region": ", Arab"code: ", BH, ", "name_ar": "Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†", "region": ", Arab"code: ", OM, ", "name_ar": "Ø¹ÙÙ…Ø§Ù†", "region": ", Arab"code: ", YE, ", "name_ar": "Ø§Ù„ÙŠÙ…Ù†", "region": ", Arab"code: ", MA, ", "name_ar": "Ø§Ù„Ù…ØºØ±Ø¨", "region": ", Arab"code: ", DZ, ", "name_ar": "Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±", "region": ", Arab"code: ", TN, ", "name_ar": "ØªÙˆÙ†Ø³", "region": ", Arab"code: ", LY, ", "name_ar": "Ù„ÙŠØ¨ÙŠØ§", "region": ", Arab"code: ", SD, ", "name_ar": "Ø§Ù„Ø³ÙˆØ¯Ø§Ù†", "region": ", Arab"code: ", PS, ", "name_ar": "ÙÙ„Ø³Ø·ÙŠÙ†", "region": ", Arab"code: ", TR, ", "name_ar": "ØªØ±ÙƒÙŠØ§", "region": ", Asia"code: ", IN, ", "name_ar": "Ø§Ù„Ù‡Ù†Ø¯", "region": ", Asia"code: ", TH, ", "name_ar": "ØªØ§ÙŠÙ„Ø§Ù†Ø¯", "region": ", Asia"code: ", GB, ", "name_ar": "Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ù…ØªØ­Ø¯Ø© (Ø¥Ù†Ø¬Ù„ØªØ±Ø§)", "region": ", Europe"}"
        ]
        return {"countries": countries}
    except Exception as e:
        return {"error": str(e), "countries": []}


@app.get("/api/cities/{country_code}")
async def get_cities(country_code: str):
    "Ø¬Ù„Ø¨ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ù† Ù„Ø¯ÙˆÙ„Ø© Ù…Ø¹ÙŠÙ†Ø©"""
    try:
        # Ù…Ø­Ø§ÙƒØ§Ø© Ø¬Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        cities_data = {
            SA, ": ["Ø§Ù„Ø±ÙŠØ§Ø¶", "Ø¬Ø¯Ø©", "Ù…ÙƒØ© Ø§Ù„Ù…ÙƒØ±Ù…Ø©", "Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø©", "Ø§Ù„Ø¯Ù…Ø§Ù…", "Ø§Ù„Ø®Ø¨Ø±", "ØªØ¨ÙˆÙƒ", "Ø£Ø¨Ù‡Ø§", "Ø§Ù„Ø·Ø§Ø¦Ù", "Ø¨Ø±ÙŠØ¯Ø©", AE: ["Ø£Ø¨ÙˆØ¸Ø¨ÙŠ", "Ø¯Ø¨ÙŠ", "Ø§Ù„Ø´Ø§Ø±Ù‚Ø©", "Ø¹Ø¬Ù…Ø§Ù†", "Ø£Ù… Ø§Ù„Ù‚ÙŠÙˆÙŠÙ†", "Ø±Ø£Ø³ Ø§Ù„Ø®ÙŠÙ…Ø©", "Ø§Ù„ÙØ¬ÙŠØ±Ø©", "Ø§Ù„Ø¹ÙŠÙ†", EG: ["Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©", "Ø§Ù„Ø¥Ø³ÙƒÙ†Ø¯Ø±ÙŠØ©", "Ø§Ù„Ø¬ÙŠØ²Ø©", "Ø´Ø¨Ø±Ø§ Ø§Ù„Ø®ÙŠÙ…Ø©", "Ø¨ÙˆØ±Ø³Ø¹ÙŠØ¯", "Ø§Ù„Ø³ÙˆÙŠØ³", "Ø§Ù„Ø£Ù‚ØµØ±", "Ø£Ø³ÙˆØ§Ù†", JO: ["Ø¹Ù…Ø§Ù†", "Ø¥Ø±Ø¨Ø¯", "Ø§Ù„Ø²Ø±Ù‚Ø§Ø¡", "Ø§Ù„Ø±ØµÙŠÙØ©", "ÙˆØ§Ø¯ÙŠ Ø§Ù„Ø³ÙŠØ±", "Ø§Ù„Ø¹Ù‚Ø¨Ø©", "Ø§Ù„Ø³Ù„Ø·", "Ù…Ø§Ø¯Ø¨Ø§", TR: ["Ø£Ù†Ù‚Ø±Ø©", "Ø¥Ø³Ø·Ù†Ø¨ÙˆÙ„", "Ø¥Ø²Ù…ÙŠØ±", "Ø¨ÙˆØ±ØµØ©", "Ø£Ø¶Ù†Ø©", "ØºØ§Ø²ÙŠ Ø¹Ù†ØªØ§Ø¨", "Ù‚ÙˆÙ†ÙŠØ§", "Ø£Ù†Ø·Ø§Ù„ÙŠØ§", IN: ["Ù†ÙŠÙˆØ¯Ù„Ù‡ÙŠ", "Ù…ÙˆÙ…Ø¨Ø§ÙŠ", "ÙƒÙˆÙ„ÙƒØ§ØªØ§", "ØªØ´ÙŠÙ†Ø§ÙŠ", "Ø¨Ù†ØºØ§Ù„ÙˆØ±", "Ø­ÙŠØ¯Ø± Ø¢Ø¨Ø§Ø¯", "Ø£Ø­Ù…Ø¯ Ø¢Ø¨Ø§Ø¯", "Ø¨ÙˆÙ†Ø§", TH: ["Ø¨Ø§Ù†ÙƒÙˆÙƒ", "Ù†ÙˆÙ†ØªØ§Ø¨ÙˆØ±ÙŠ", "Ù†Ø®ÙˆÙ† Ø±Ø§ØªØ´Ø§Ø³ÙŠÙ…Ø§", "Ø´ÙŠØ§Ù†Øº Ù…Ø§ÙŠ", "Ù‡Ø§Øª ÙŠØ§ÙŠ", "Ø£ÙˆØ¯ÙˆÙ† Ø«Ø§Ù†ÙŠ", GB: ["Ù„Ù†Ø¯Ù†", "Ø¨Ø±Ù…Ù†ØºÙ‡Ø§Ù…", "Ù…Ø§Ù†Ø´Ø³ØªØ±", "Ù„ÙŠØ¯Ø²", "ØºÙ„Ø§Ø³ÙƒÙˆ", "Ø´ÙŠÙÙŠÙ„Ø¯", "Ù„ÙŠÙØ±Ø¨ÙˆÙ„", "Ø¥Ø¯Ù†Ø¨Ø±Ø©"]"
        }

        cities = cities_data.get(country_code.upper(), [])
        return {"cities": cities, "country_code": country_code}
    except Exception as e:
        return {"error": str(e), "cities": []}


# Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª
@app.exception_handler(Exception)
async def global_exception_handler(
    request: Request, exc: Exception
) -> JSONResponse:
    ""
    Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª Ø§Ù„Ø¹Ø§Ù…
    ÙŠÙ„ØªÙ‚Ø· Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© ÙˆÙŠØ¹ÙŠØ¯ Ø§Ø³ØªØ¬Ø§Ø¨Ø© JSON Ù…Ù†Ø§Ø³Ø¨Ø©
    ""
    _ = request  # ØªØ¬Ø§Ù‡Ù„ Ø§Ù„ØªØ­Ø°ÙŠØ± - Ù‚Ø¯ Ù†Ø­ØªØ§Ø¬ request ÙÙŠ Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„
    logger.error(fØ­Ø¯Ø« Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø§Ù„Ø¬: {str(exc)}", exc_info=True)"
    return JSONResponse(
        status_code=500,
        content={"detail": "Ø­Ø¯Ø« Ø®Ø·Ø£ Ø¯Ø§Ø®Ù„ÙŠ ÙÙŠ Ø§Ù„Ø®Ø§Ø¯Ù…"},
    )

# ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Ø§Ù„Ù…Ù„Ù Ù…Ø¨Ø§Ø´Ø±Ø©
if __name__ == ", __main__, ":
    # Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° Ù…Ù† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦ÙŠØ© Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù†ÙØ° Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
    port = int(os.environ.get(", PORT, ", 8031))

    # ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… uvicorn
    logger.info(f"Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ÙØ° {port}")
    uvicorn.run("src.main:app", host="0.0.0.0", port=port, reload=True)
