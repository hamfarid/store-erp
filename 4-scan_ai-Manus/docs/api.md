# توثيق الواجهة البرمجية (API) لنظام Gaara AI

**الإصدار:** 1.0.0  
**تاريخ التوثيق:** 2025-11-15  
**الموثق:** Manus AI

---

## مقدمة

هذا المستند يوفر توثيقاً شاملاً لجميع نقاط النهاية (Endpoints) في الواجهة البرمجية لنظام Gaara AI. جميع الطلبات والاستجابات تستخدم صيغة **JSON**.

**عنوان URL الأساسي:** `/api`

### المصادقة

تعتمد معظم نقاط النهاية على المصادقة باستخدام **JWT (JSON Web Token)**. يجب إرسال التوكن في رأس الطلب (Header) كالتالي:

```
Authorization: Bearer <YOUR_ACCESS_TOKEN>
```

---

## 1. المصادقة (Authentication)

### 1.1 تسجيل مستخدم جديد

*   **الطريقة:** `POST`
*   **المسار:** `/auth/register`
*   **الوصف:** إنشاء حساب مستخدم جديد في النظام.
*   **المصادقة:** لا يتطلب.

**الطلب (Request Body):**

```json
{
  "username": "newuser",
  "email": "newuser@example.com",
  "password": "a_strong_password"
}
```

**الاستجابة (Success 201):**

```json
{
  "message": "تم تسجيل المستخدم بنجاح"
}
```

### 1.2 تسجيل الدخول

*   **الطريقة:** `POST`
*   **المسار:** `/auth/login`
*   **الوصف:** مصادقة المستخدم وإرجاع توكن الوصول.
*   **المصادقة:** لا يتطلب.

**الطلب (Request Body):**

```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

**الاستجابة (Success 200):**

```json
{
  "access_token": "<JWT_ACCESS_TOKEN>",
  "user": {
    "id": 1,
    "username": "testuser",
    "email": "user@example.com",
    "role": "user"
  }
}
```

### 1.3 الحصول على الملف الشخصي

*   **الطريقة:** `GET`
*   **المسار:** `/auth/profile`
*   **الوصف:** الحصول على معلومات الملف الشخصي للمستخدم الحالي.
*   **المصادقة:** يتطلب JWT.

**الاستجابة (Success 200):**

```json
{
  "user": {
    "id": 1,
    "username": "testuser",
    "email": "user@example.com",
    "first_name": "Test",
    "last_name": "User",
    "role": "user"
  }
}
```

---

## 2. المزارع (Farms)

### 2.1 الحصول على قائمة المزارع

*   **الطريقة:** `GET`
*   **المسار:** `/farms`
*   **الوصف:** الحصول على قائمة بجميع المزارع المرتبطة بالمستخدم.
*   **المصادقة:** يتطلب JWT.

### 2.2 إنشاء مزرعة جديدة

*   **الطريقة:** `POST`
*   **المسار:** `/farms`
*   **الوصف:** إنشاء مزرعة جديدة.
*   **المصادقة:** يتطلب JWT.

**الطلب (Request Body):**

```json
{
  "name": "مزرعتي الجديدة",
  "location": "الرياض",
  "area": 5000.5
}
```

---

## 3. التشخيص (Diagnosis)

### 3.1 إنشاء تشخيص جديد

*   **الطريقة:** `POST`
*   **المسار:** `/diagnosis`
*   **الوصف:** رفع صورة نبات لإنشاء تشخيص جديد للمرض.
*   **المصادقة:** يتطلب JWT.
*   **نوع المحتوى:** `multipart/form-data`

**الطلب (Form Data):**

*   `image`: ملف الصورة (e.g., `plant_image.jpg`)
*   `plant_id`: (اختياري) `123`

**الاستجابة (Success 201):**

```json
{
  "message": "تم استلام الصورة، جاري المعالجة...",
  "diagnosis_id": 42
}
```

### 3.2 الحصول على قائمة التشخيصات

*   **الطريقة:** `GET`
*   **المسار:** `/diagnosis`
*   **الوصف:** الحصول على سجل التشخيصات للمستخدم الحالي.
*   **المصادقة:** يتطلب JWT.

---

## 4. الإحصائيات (Statistics)

### 4.1 إحصائيات لوحة التحكم

*   **الطريقة:** `GET`
*   **المسار:** `/stats/dashboard`
*   **الوصف:** الحصول على إحصائيات مجمعة لعرضها في لوحة التحكم.
*   **المصادقة:** يتطلب JWT.

---

## 5. النظام (System)

### 5.1 التحقق من صحة النظام

*   **الطريقة:** `GET`
*   **المسار:** `/health`
*   **الوصف:** التحقق من أن الواجهة الخلفية تعمل بشكل صحيح.
*   **المصادقة:** لا يتطلب.

**الاستجابة (Success 200):**

```json
{
  "status": "ok",
  "timestamp": "2025-11-15T14:00:00Z"
}
```

### 5.2 النسخ الاحتياطي والاستعادة

*   **الطريقة:** `POST`
*   **المسار:** `/backup` أو `/restore`
*   **الوصف:** إنشاء أو استعادة نسخة احتياطية من النظام.
*   **المصادقة:** يتطلب صلاحيات مدير (Admin).

### 5.3 الإعدادات

*   **الطريقة:** `GET`, `POST`
*   **المسار:** `/settings`
*   **الوصف:** الحصول على إعدادات النظام أو تحديثها.
*   **المصادقة:** يتطلب صلاحيات مدير (Admin).
