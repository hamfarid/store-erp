# دليل النظام الشامل - حاويات Docker المتقدمة لنظام Gaara Scan AI

## نظرة عامة

تم تطوير نظام حاويات Docker شامل ومتقدم لنظام Gaara Scan AI يتضمن جميع الخدمات المطلوبة مع ترتيب البناء المحسن والتكامل الكامل.

## الحاويات المتوفرة

### 1. البنية التحتية الأساسية

#### PostgreSQL المخصصة (gaara-postgres-db)
- **الوصف**: قاعدة بيانات PostgreSQL محسنة مع إضافات متقدمة
- **المنفذ**: 5432
- **الميزات**:
  - دعم البحث النصي العربي
  - إضافات متقدمة (uuid-ossp, pgcrypto, hstore, pg_trgm)
  - تكوين محسن للأداء
  - نسخ احتياطي تلقائي
  - فهرسة متقدمة

#### Redis (gaara-redis-cache)
- **الوصف**: تخزين مؤقت عالي الأداء
- **المنفذ**: 6379
- **الاستخدام**: تخزين الجلسات، التخزين المؤقت، قوائم الانتظار

#### RabbitMQ (gaara-rabbitmq-broker)
- **الوصف**: وسيط رسائل متقدم
- **المنافذ**: 5672 (AMQP), 15672 (إدارة), 15692 (مقاييس)
- **الميزات**:
  - إدارة الرسائل المتقدمة
  - مراقبة الأداء
  - تجميع الرسائل
  - إعادة المحاولة التلقائية

### 2. قواعد البيانات المتقدمة

#### Elasticsearch (gaara-elasticsearch-search)
- **الوصف**: محرك بحث وتحليل متقدم
- **المنافذ**: 9200 (HTTP), 9300 (Transport)
- **الميزات**:
  - بحث نصي متقدم
  - دعم اللغة العربية
  - فهرسة ذكية
  - تحليل البيانات

#### Vector Database (gaara-vector-database)
- **الوصف**: قاعدة بيانات شعاعية للذكاء الاصطناعي
- **المنفذ**: 8006
- **الاستخدام**: تخزين واسترجاع المتجهات للبحث الدلالي

### 3. خدمات الذكاء الاصطناعي

#### Memory Service (gaara-memory-system)
- **الوصف**: نظام الذاكرة القصيرة والطويلة المدى
- **المنفذ**: 8005
- **الميزات**:
  - ذاكرة قصيرة المدى (TTL: 1 ساعة)
  - ذاكرة طويلة المدى (30 يوم)
  - تكامل مع Vector Database

#### ResNet-50 Service (gaara-resnet50-ai)
- **الوصف**: خدمة التعلم العميق للتشخيص
- **المنفذ**: 8003
- **الاستخدام**: تشخيص أمراض النباتات، تحليل الصور

#### AI Agents Service (gaara-ai-agents-system)
- **الوصف**: نظام وكلاء الذكاء الاصطناعي
- **المنفذ**: 8004
- **الميزات**:
  - وكلاء متخصصون
  - تفاعل A2A
  - إدارة المهام الذكية

### 4. خدمات التشخيص والتحليل

#### Diagnosis Service (gaara-diagnosis-engine)
- **الوصف**: محرك التشخيص الذكي
- **المنفذ**: 8001
- **الميزات**:
  - تشخيص أمراض النباتات
  - تحليل الصور
  - توصيات العلاج

#### Analytics Service (gaara-analytics-engine)
- **الوصف**: محرك التحليلات المتقدم
- **المنفذ**: 8002
- **الميزات**:
  - تحليل البيانات الضخمة
  - إنشاء التقارير
  - الذكاء التجاري

### 5. خدمات الاتصالات

#### WebSocket Service (gaara-websocket-realtime)
- **الوصف**: خدمة الاتصال الفوري
- **المنفذ**: 8007
- **الميزات**:
  - اتصال ثنائي الاتجاه
  - غرف الدردشة
  - إشعارات فورية
  - Rate Limiting

#### Notification Service (gaara-notification-system)
- **الوصف**: نظام الإشعارات الذكي
- **المنفذ**: 8008
- **الميزات**:
  - إشعارات البريد الإلكتروني
  - الرسائل النصية
  - الإشعارات المحمولة
  - قوالب متقدمة

### 6. خدمات المراقبة

#### Prometheus (gaara-prometheus-metrics)
- **الوصف**: جمع المقاييس والمراقبة
- **المنفذ**: 9090
- **الميزات**: مراقبة جميع الخدمات، تنبيهات ذكية

#### Grafana (gaara-grafana-dashboard)
- **الوصف**: لوحات تحكم تفاعلية
- **المنفذ**: 3000
- **الميزات**: تصور البيانات، تقارير مرئية

#### Kibana (gaara-kibana-analytics)
- **الوصف**: تحليل وتصور البيانات
- **المنفذ**: 5601
- **الميزات**: تحليل السجلات، البحث المتقدم

### 7. إدارة النظام

#### Portainer (gaara-portainer-manager)
- **الوصف**: إدارة Docker المرئية
- **المنفذ**: 9000
- **الميزات**: إدارة الحاويات، مراقبة الموارد

#### Watchtower (gaara-watchtower-updater)
- **الوصف**: تحديث تلقائي للحاويات
- **الميزات**: تحديثات آمنة، إشعارات Slack

### 8. التطبيق الرئيسي

#### Main Application (gaara-main-application)
- **الوصف**: التطبيق الرئيسي لنظام Gaara Scan AI
- **المنفذ**: 8000
- **الميزات**:
  - واجهة المستخدم الرئيسية
  - API موحد
  - تكامل مع جميع الخدمات
  - **ملاحظة**: آخر حاوية يتم إنشاؤها

## ترتيب البناء والتشغيل

تم تصميم النظام ليتم بناؤه وتشغيله بترتيب محدد لضمان التكامل الصحيح:

### المرحلة 1: البنية التحتية
1. PostgreSQL
2. Redis  
3. RabbitMQ

### المرحلة 2: قواعد البيانات المتقدمة
4. Elasticsearch
5. Vector Database

### المرحلة 3: خدمات الذكاء الاصطناعي
6. Memory Service
7. ResNet-50 Service
8. AI Agents Service

### المرحلة 4: خدمات التشخيص والتحليل
9. Diagnosis Service
10. Analytics Service

### المرحلة 5: خدمات الاتصالات
11. WebSocket Service
12. Notification Service

### المرحلة 6: المراقبة
13. Prometheus
14. Grafana
15. Kibana
16. Node Exporter
17. cAdvisor

### المرحلة 7: الإدارة
18. Portainer
19. Watchtower

### المرحلة 8: الواجهة الأمامية
20. Nginx Reverse Proxy

### المرحلة 9: التطبيق الرئيسي (الأخير)
21. **Main Application** - آخر حاوية يتم إنشاؤها

## الشبكات

تم تقسيم النظام إلى شبكات منطقية:

- **gaara-infrastructure**: البنية التحتية الأساسية
- **gaara-services**: خدمات التطبيق
- **gaara-monitoring**: خدمات المراقبة  
- **gaara-ai**: خدمات الذكاء الاصطناعي

## الأحجام المستمرة

- **gaara_postgres_data**: بيانات PostgreSQL
- **gaara_redis_data**: بيانات Redis
- **gaara_elasticsearch_data**: بيانات Elasticsearch
- **gaara_models_data**: نماذج الذكاء الاصطناعي
- **gaara_vector_data**: بيانات Vector Database
- **gaara_memory_data**: بيانات الذاكرة
- **gaara_app_uploads**: ملفات المستخدمين
- **gaara_app_static**: الملفات الثابتة
- **gaara_app_logs**: سجلات التطبيق

## الإعداد الأولي

### 1. صفحة الإعدادات الأولية
عند أول تشغيل للنظام، ستظهر صفحة الإعدادات التي تطلب:

- **معلومات الشركة**: الاسم، العنوان، الهاتف، البريد الإلكتروني
- **الإعدادات المالية**: العملة الافتراضية، الرقم الضريبي
- **إعدادات النظام**: اللغة، المنطقة الزمنية
- **حساب المدير**: البريد الإلكتروني وكلمة المرور
- **تفعيل الخدمات**: الذكاء الاصطناعي، الإشعارات، المراقبة

### 2. ملف .env
يتم إنشاء ملف .env تلقائياً مع:
- كلمات مرور عشوائية آمنة
- إعدادات الاتصال بقواعد البيانات
- مفاتيح التشفير
- إعدادات الخدمات الخارجية

## التشغيل

### التشغيل السريع
```bash
# تشغيل سكريبت الإعداد الشامل
./scripts/setup_and_run.sh
```

### التشغيل اليدوي
```bash
# إنشاء ملف .env
cp .env.example .env

# بناء وتشغيل جميع الخدمات
docker-compose up -d

# أو تشغيل مرحلي
docker-compose up -d gaara-postgres gaara-redis gaara-rabbitmq
docker-compose up -d gaara-elasticsearch gaara-vector-db
# ... باقي الخدمات
docker-compose up -d gaara-main-app  # آخر حاوية
```

## الوصول للخدمات

- **التطبيق الرئيسي**: http://localhost
- **صفحة الإعدادات**: http://localhost/setup
- **Grafana**: http://localhost/grafana
- **Kibana**: http://localhost/kibana  
- **Portainer**: http://localhost:9000
- **RabbitMQ Management**: http://localhost:15672

## الصيانة والتحديث

### تحديث حاوية واحدة
```bash
# إيقاف الحاوية
docker-compose stop gaara-main-app

# إعادة بناء وتشغيل
docker-compose up -d --build gaara-main-app
```

### النسخ الاحتياطي
```bash
# نسخ احتياطي لقاعدة البيانات
docker-compose exec gaara-postgres pg_dump -U gaara_user gaara_scan_ai > backup.sql

# نسخ احتياطي للأحجام
docker run --rm -v gaara_postgres_data:/data -v $(pwd):/backup alpine tar czf /backup/postgres_backup.tar.gz /data
```

## الأمان

- جميع كلمات المرور يتم توليدها عشوائياً
- شبكات معزولة للخدمات المختلفة
- تشفير الاتصالات بين الخدمات
- فحص صحة دوري لجميع الحاويات
- تحديثات أمنية تلقائية

## المراقبة والتنبيهات

- مراقبة مستمرة لجميع الخدمات
- تنبيهات عند فشل الخدمات
- مقاييس الأداء والاستخدام
- سجلات مركزية ومنظمة

هذا النظام يوفر بيئة شاملة ومتكاملة لتشغيل نظام Gaara Scan AI بكفاءة عالية وأمان متقدم.

