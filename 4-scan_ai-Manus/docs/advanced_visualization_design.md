# تصميم قدرات التصور المتقدمة

## 1. مقدمة

يهدف هذا المستند إلى تصميم قدرات تصور بيانات متقدمة لنظام الذكاء الاصطناعي الزراعي. ستتجاوز هذه القدرات الرسوم البيانية الأساسية التي تم تنفيذها مسبقًا، وستوفر رؤى أعمق حول أداء النموذج، ونتائج التحليل، ومقاييس النظام من خلال تصورات تفاعلية وثابتة عالية الجودة.

## 2. الأهداف

*   **تصور أداء النموذج**: عرض مقاييس أداء النموذج التفصيلية مثل مصفوفات الارتباك (Confusion Matrices)، منحنيات ROC، ومنحنيات الدقة والاستدعاء (Precision-Recall Curves).
*   **تصور نتائج التحليل**: تقديم تصورات تفاعلية لنتائج تحليل الأمراض ونقص العناصر، وربما تصورات جغرافية مكانية إذا توفرت بيانات الموقع.
*   **تصور مقارنات التحليل**: عرض مقارنات مرئية بين نتائج التحليل القياسي والتحليل الأولي.
*   **تصور مقاييس المراقبة**: إنشاء لوحة معلومات أو رسوم بيانية تفاعلية لمقاييس النظام والتطبيق التي تم جمعها بواسطة نظام المراقبة (مثل استخدام الموارد، معدلات الطلبات، زمن الاستجابة عبر الوقت).
*   **التفاعلية**: تمكين المستخدمين من استكشاف البيانات بشكل تفاعلي (تكبير/تصغير، تحريك، تصفية).

## 3. التقنيات والمكتبات المقترحة

*   **Backend (Python)**:
    *   **Plotly**: لإنشاء مجموعة واسعة من الرسوم البيانية التفاعلية (خطية، شريطية، مبعثرة، مصفوفات ارتباك، خرائط حرارية، إلخ) التي يمكن تصديرها كـ JSON لتضمينها في الواجهة الأمامية أو حفظها كصور ثابتة.
    *   **Seaborn / Matplotlib**: لإنشاء رسوم بيانية ثابتة عالية الجودة (خاصة مصفوفات الارتباك والخرائط الحرارية) يمكن حفظها كملفات صور.
    *   **Pandas**: لمعالجة وتحضير البيانات للتصور.
    *   **Scikit-learn**: لحساب مقاييس الأداء اللازمة للرسوم البيانية (مثل منحنيات ROC).
*   **Frontend (JavaScript)**:
    *   **Plotly.js**: لعرض الرسوم البيانية التفاعلية التي تم إنشاؤها بواسطة Plotly (Python) في الواجهة الأمامية.
    *   **Chart.js**: للاستمرار في استخدامه للرسوم البيانية الأبسط في لوحة المعلومات.
    *   **Leaflet (اختياري)**: إذا تم تنفيذ التصور الجغرافي المكاني.

## 4. التصورات المقترحة

1.  **لوحة معلومات المراقبة (Monitoring Dashboard)**:
    *   **البيانات**: مقاييس النظام والتطبيق من `MetricsCollector`.
    *   **النوع**: رسوم بيانية خطية تفاعلية (Plotly.js) تعرض استخدام CPU، الذاكرة، معدل الطلبات، معدل الأخطاء، متوسط زمن الاستجابة عبر الوقت.
    *   **الموقع**: قسم جديد في الواجهة الأمامية (`dashboard.html` أو جزء في `index.html`).
2.  **تصورات أداء النموذج (Model Performance Visualizations)**:
    *   **البيانات**: مصفوفات الارتباك، منحنيات ROC، منحنيات الدقة والاستدعاء (محسوبة بعد التقييم).
    *   **النوع**: صور ثابتة (Seaborn/Matplotlib لمصفوفة الارتباك) ورسوم بيانية تفاعلية (Plotly لمنحنيات ROC/PR).
    *   **الموقع**: يمكن عرضها في الواجهة الأمامية بعد اكتمال التدريب أو التقييم، أو حفظها كملفات في مجلد النموذج.
3.  **تصور نتائج التحليل المقارن (Comparative Analysis Visualization)**:
    *   **البيانات**: نتائج التحليل من النظام القياسي والنظام الأولي.
    *   **النوع**: رسم بياني شريطي مقارن أو جدول تفاعلي يعرض الثقة أو الاحتمالات لكل فئة من كلا النظامين.
    *   **الموقع**: في صفحة نتائج التحليل في الواجهة الأمامية.

## 5. التنفيذ المقترح

1.  **إنشاء وحدة تصور جديدة**: إنشاء `src/visualization/visualizer.py`.
    *   إضافة وظائف لإنشاء الرسوم البيانية باستخدام Plotly و Seaborn/Matplotlib.
    *   وظيفة لإنشاء مصفوفة ارتباك (باستخدام Seaborn/Matplotlib).
    *   وظيفة لإنشاء منحنيات ROC/PR (باستخدام Scikit-learn و Plotly).
    *   وظيفة لتصدير رسوم Plotly كـ JSON.
2.  **تعديل وحدة التدريب (`enhanced_training.py`)**: استدعاء وظائف التصور بعد تقييم النموذج لحفظ رسوم الأداء.
3.  **تعديل وحدة المراقبة (`metrics_collector.py` / `alerter.py` أو وحدة جديدة)**: إضافة وظائف لاسترداد بيانات المقاييس التاريخية وتحضيرها للتصور.
4.  **تعديل الواجهة الأمامية (`index.html`, `script.js`)**:
    *   إضافة مكتبة Plotly.js.
    *   إنشاء قسم جديد للوحة معلومات المراقبة.
    *   استخدام JavaScript لجلب بيانات المقاييس من نقطة نهاية API (إذا تم إنشاؤها) أو تحميلها من ملفات JSON وعرضها باستخدام Plotly.js.
    *   تعديل عرض نتائج التحليل لتضمين الرسوم البيانية المقارنة.
    *   عرض صور رسوم الأداء الثابتة عند الاقتضاء.
5.  **تعديل `main.py`**: دمج استدعاءات وظائف التصور عند الحاجة (مثل بعد التحليل المقارن).

## 6. الاعتبارات

*   **الأداء**: يجب أن يكون تحميل وعرض الرسوم البيانية التفاعلية فعالاً، خاصة مع مجموعات البيانات الكبيرة.
*   **نقل البيانات**: نقل بيانات الرسوم البيانية (خاصة JSON لـ Plotly) من الخلفية إلى الواجهة الأمامية يجب أن يكون محسّنًا.
*   **تجربة المستخدم**: يجب أن تكون الرسوم البيانية واضحة وسهلة الفهم والتفاعل.
